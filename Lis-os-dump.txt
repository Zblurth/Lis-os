{"_meta":{"note":"Format: JSONL. Full System Dump.","os":"NixOS-Unstable","wm":"Niri"},"rules":{"imports":"Explicit defaults only.","safety":"NO sed. Use cat <<EOF to OVERWRITE files.","structure":{"cli":"modules/core/packages.nix","gui":"modules/home/packages.nix","sys":"modules/core/*","user":"modules/home/*"}}}
{"p":".gitignore","c":"result\nresult-*\n*.xml\nrepomix-output.txt\n.zed/\n*.swp\n.bash_history\n.zsh_history\n*.qcow2"}
{"p":"flake.nix","c":"{\n  description = \"Lis-os\";\n  inputs = {\n      nixpkgs.url = \"github:nixos/nixpkgs/nixos-unstable\";\n      home-manager = {\n        url = \"github:nix-community/home-manager\";\n        inputs.nixpkgs.follows = \"nixpkgs\";\n      };\n      stylix = {\n        url = \"github:danth/stylix\";\n        inputs.nixpkgs.follows = \"nixpkgs\";\n      };\n      noctalia = {\n        url = \"github:noctalia-dev/noctalia-shell\";\n        inputs.nixpkgs.follows = \"nixpkgs\";\n      };\n    };\n  outputs =\n    { nixpkgs, flake-utils, ... }@inputs:\n    let\n      system = \"x86_64-linux\";\n      mkHost =\n        {\n          hostname,\n          profile,\n          username,\n        }:\n        nixpkgs.lib.nixosSystem {\n          inherit system;\n          specialArgs = {\n            inherit inputs;\n            host = hostname;\n            inherit profile;\n            inherit username;\n          };\n          modules = [\n            ./hosts/default.nix\n          ];\n        };\n    in\n    {\n      nixosConfigurations = {\n        nixos = mkHost {\n          hostname = \"nixos\";\n          profile = \"amd\";\n          username = \"lune\";\n        };\n      };\n    };\n}"}
{"p":"hosts/default.nix","c":"{ pkgs, inputs, ... }: # <--- 1. ADD 'inputs' HERE\n{\n  imports = [\n    inputs.stylix.nixosModules.stylix # <--- 2. ADD THIS LINE (Loads the Stylix software)\n    ./hardware.nix\n    ../modules/core/boot.nix\n    ../modules/core/hardware.nix\n    ../modules/core/drivers.nix\n    ../modules/core/system.nix\n    ../modules/core/user.nix\n    ../modules/core/security.nix\n    ../modules/core/network.nix\n    ../modules/core/services.nix\n    ../modules/core/packages.nix\n    ../modules/core/portals.nix\n    ../modules/core/fonts.nix\n    ../modules/core/appimage.nix\n    ../modules/core/greetd.nix\n    ../modules/core/stylix.nix\n    ../modules/core/nh.nix\n    ../modules/core/steam.nix\n  ];\n  programs.niri.package = pkgs.niri;\n}"}
{"p":"hosts/hardware.nix","c":"{\n  config,\n  lib,\n  modulesPath,\n  ...\n}:\n{\n  imports = [\n    (modulesPath + \"/installer/scan/not-detected.nix\")\n  ];\n  boot.initrd.availableKernelModules = [\n    \"nvme\"\n    \"xhci_pci\"\n    \"ahci\"\n    \"usbhid\"\n  ];\n  boot.initrd.kernelModules = [ ];\n  boot.kernelModules = [ \"kvm-amd\" ];\n  boot.extraModulePackages = [ ];\n  fileSystems.\"/\" = {\n    device = \"/dev/disk/by-uuid/ee1fa0da-4a03-4f83-954c-e48b611d8c9d\";\n    fsType = \"ext4\";\n  };\n  fileSystems.\"/boot\" = {\n    device = \"/dev/disk/by-uuid/2B64-B786\";\n    fsType = \"vfat\";\n    options = [\n      \"fmask=0077\"\n      \"dmask=0077\"\n    ];\n  };\n  swapDevices = [\n    { device = \"/dev/disk/by-uuid/c86b46d7-91a9-410e-bfc4-375bf511f7fa\"; }\n  ];\n  networking.useDHCP = lib.mkDefault true;\n  nixpkgs.hostPlatform = lib.mkDefault \"x86_64-linux\";\n  hardware.cpu.amd.updateMicrocode = lib.mkDefault config.hardware.enableRedistributableFirmware;\n}"}
{"p":"hosts/variables.nix","c":"{\n  gitUsername = \"lune\";\n  gitEmail = \"lune@nixos\";\n  timeZone = \"Europe/Paris\";\n  monitorConfig = ''\n    output \"DP-2\" {\n        mode \"3440x1440@100.000\"\n        scale 1.0\n        position x=0 y=0\n    }\n  '';\n  clock24h = false;\n  browser = \"vivaldi\";\n  terminal = \"kitty\";\n  keyboardLayout = \"us\";\n  consoleKeyMap = \"us\";\n  thunarEnable = true;\n  stylixEnable = true;\n  barChoice = \"noctalia\";\n  defaultShell = \"zsh\";\n  stylixImage = ../wallpapers/Valley.jpg;\n  startupApps = [ ];\n}"}
{"p":"modules/core/appimage.nix","c":"{ pkgs, ... }:\n{\n  boot.binfmt.registrations.appimage = {\n    wrapInterpreterInShell = false;\n    interpreter = \"${pkgs.appimage-run}/bin/appimage-run\";\n    recognitionType = \"magic\";\n    offset = 0;\n    mask = ''\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x00\\xff\\xff\\xff'';\n    magicOrExtension = ''\\x7fELF....AI\\x02'';\n  };\n  environment.systemPackages = [ pkgs.appimage-run ];\n  programs.fuse.userAllowOther = true;\n}"}
{"p":"modules/core/boot.nix","c":"{ pkgs, ... }:\n{\n  boot = {\n    kernelPackages = pkgs.linuxPackages;\n    loader.systemd-boot.enable = true;\n    loader.efi.canTouchEfiVariables = true;\n    plymouth.enable = true;\n  };\n}"}
{"p":"modules/core/drivers.nix","c":"{ pkgs, config, ... }:\n{\n  hardware.graphics = {\n    enable = true;\n    enable32Bit = true;\n  };\n  services.xserver.videoDrivers = [ \"amdgpu\" ];\n  systemd.tmpfiles.rules = [\n    \"L+    /opt/rocm/hip   -    -    -     -    ${pkgs.rocmPackages.clr}\"\n  ];\n  boot.kernelModules = [\n    \"it87\"\n    \"v4l2loopback\"\n  ];\n  boot.extraModulePackages = [\n    config.boot.kernelPackages.v4l2loopback\n    config.boot.kernelPackages.it87\n  ];\n  programs.coolercontrol.enable = true;\n   programs.corectrl.enable = true; # Disabled for stability\n   hardware.amdgpu.overdrive = {\n     enable = true;\n     ppfeaturemask = \"0xffffffff\";\n   };\n}"}
{"p":"modules/core/fonts.nix","c":"{ pkgs, ... }: {\n  fonts = {\n    fontconfig = {\n      enable = true;\n      defaultFonts = {\n        serif = [ \"Jost\" \"Noto Serif\" \"Noto Serif CJK SC\" ];\n        sansSerif = [ \"Jost\" \"Noto Sans\" \"Noto Sans CJK SC\" ];\n        monospace = [ \"JetBrains Mono\" \"Noto Sans Mono CJK SC\" ];\n      };\n    };\n    packages = with pkgs; [\n      jost  # Your main font\n      jetbrains-mono  # Terminal/code\n      noto-fonts\n      noto-fonts-cjk-sans\n      noto-fonts-cjk-serif\n      noto-fonts-color-emoji\n      font-awesome\n    ];\n  };\n}"}
{"p":"modules/core/greetd.nix","c":"{ pkgs, ... }:\n{\n  services.greetd = {\n    enable = true;\n    settings = {\n      default_session = {\n        command = \"${pkgs.tuigreet}/bin/tuigreet --time --remember --cmd niri-session\";\n        user = \"greeter\";\n      };\n    };\n  };\n  security.pam.services.greetd.enableGnomeKeyring = true;\n  environment.systemPackages = [ pkgs.tuigreet ];\n}"}
{"p":"modules/core/hardware.nix","c":"{ pkgs, config, ... }:\n{\n  hardware = {\n    sane = {\n      enable = true;\n      extraBackends = [ pkgs.sane-airscan ];\n      disabledDefaultBackends = [ \"escl\" ];\n    };\n    graphics.enable = true;\n    enableRedistributableFirmware = true;\n    bluetooth.enable = true;\n    bluetooth.powerOnBoot = true;\n    i2c.enable = true;\n  };\n  boot.extraModulePackages = [ config.boot.kernelPackages.ddcci-driver ];\n  boot.kernelModules = [ \"i2c-dev\" \"ddcci_backlight\" ];\n  services.udev.extraRules = ''\n    KERNEL==\"i2c-[0-9]*\", GROUP=\"i2c\", MODE=\"0660\"\n    SUBSYSTEM==\"i2c\", ACTION==\"add\", ATTR{name}==\"AMDGPU DM*\", RUN+=\"${pkgs.bash}/bin/sh -c 'echo ddcci 0x37 > /sys/bus/i2c/devices/%k/new_device'\"\n  '';\n}"}
{"p":"modules/core/network.nix","c":"{\n  host,\n  options,\n  ...\n}: {\n  networking = {\n    hostName = \"${host}\";\n    networkmanager.enable = true;\n    timeServers = options.networking.timeServers.default ++ [\"pool.ntp.org\"];\n    firewall = {\n      enable = true;\n      allowedTCPPorts = [\n        22\n        80\n        443\n        59010\n        59011\n        8080\n      ];\n      allowedUDPPorts = [\n        59010\n        59011\n      ];\n    };\n  };\n}"}
{"p":"modules/core/nh.nix","c":"{ pkgs, username, ... }:\n{\n  programs.nh = {\n    enable = true;\n    clean = {\n      enable = true;\n      extraArgs = \"--keep-since 7d --keep 5\";\n    };\n    flake = \"/home/${username}/Lis-os\";\n  };\n  environment.variables.FLAKE = \"/home/${username}/Lis-os\";\n  environment.systemPackages = with pkgs; [\n    nix-output-monitor\n    nvd\n  ];\n}"}
{"p":"modules/core/packages.nix","c":"{ pkgs, ... }:\n{\n  nixpkgs.config.allowUnfree = true;\n  environment.systemPackages = with pkgs; [\n    git         # Version control\n    wget curl   # Network fetchers\n    unzip unrar # Archive handlers\n    nixd        # Nix Language Server\n    nil         # Alternative Nix LSP (for Zed)\n    nixfmt-rfc-style  # Formatter\n    nix-output-monitor # Better nix output\n    nvd         # Diff between generations\n    lm_sensors  # Temperature monitoring\n    pciutils    # lspci\n    usbutils    # lsusb\n    lshw        # Hardware lister\n    htop        # Interactive process viewer\n    btop        # Modern resource monitor (colorful!)\n    iotop       # Disk I/O monitoring\n    duf         # Better df alternative\n    ncdu        # Disk usage analyzer (TUI)\n    smartmontools # SMART disk monitoring\n    nmap        # Network scanner\n    iperf3      # Network performance testing\n    ethtool     # Ethernet interface config\n    wireshark   # Packet analyzer (GUI)\n    ripgrep     # Better grep\n    fd          # Better find\n    eza         # Better ls\n    bat         # Better cat (syntax highlighting)\n    fzf         # Fuzzy finder\n    file        # Determine file type\n    tree        # Directory tree view\n    rsync       # File synchronization\n    ffmpeg      # Video/audio processing\n    pipewire    # Audio server\n    wireplumber # Session manager\n  ];\n}"}
{"p":"modules/core/portals.nix","c":"{ pkgs, ... }:\n{\n  xdg.portal = {\n    enable = true;\n    wlr.enable = false; # Niri uses GNOME portal, not WLR\n    xdgOpenUsePortal = true; # Force apps to use the portal for links/files\n    extraPortals = [\n      pkgs.xdg-desktop-portal-gtk\n      pkgs.xdg-desktop-portal-gnome\n    ];\n    config = {\n      niri = {\n        default = [ \"gtk\" ]; # Use GTK for file pickers (fast)\n        \"org.freedesktop.impl.portal.ScreenCast\" = [ \"gnome\" ]; # Discord Streaming\n        \"org.freedesktop.impl.portal.Screenshot\" = [ \"gnome\" ];\n        \"org.freedesktop.impl.portal.Secret\" = [ \"gnome-keyring\" ]; # Passwords\n      };\n      common = {\n        default = [ \"gtk\" ];\n        \"org.freedesktop.impl.portal.ScreenCast\" = [ \"gnome\" ];\n        \"org.freedesktop.impl.portal.Screenshot\" = [ \"gnome\" ];\n        \"org.freedesktop.impl.portal.Secret\" = [ \"gnome-keyring\" ];\n      };\n    };\n  };\n}"}
{"p":"modules/core/security.nix","c":"_: {\n  security = {\n    rtkit.enable = true;\n    polkit = {\n      enable = true;\n      extraConfig = ''\n        polkit.addRule(function(action, subject) {\n          if ( subject.isInGroup(\"users\") && (\n           action.id == \"org.freedesktop.login1.reboot\" ||\n           action.id == \"org.freedesktop.login1.reboot-multiple-sessions\" ||\n           action.id == \"org.freedesktop.login1.power-off\" ||\n           action.id == \"org.freedesktop.login1.power-off-multiple-sessions\"\n          ))\n          { return polkit.Result.YES; }\n        })\n      '';\n    };\n    pam.services.swaylock = {\n      text = ''auth include login '';\n    };\n  };\n}"}
{"p":"modules/core/services.nix","c":"{ ... }:\n{\n  services = {\n    libinput.enable = true; # Input Handling\n    fstrim.enable = true; # SSD Optimizer\n    gvfs.enable = true; # For Mounting USB & More\n    openssh.enable = true; # Enable SSH\n    blueman.enable = true; # Bluetooth Support\n    tumbler.enable = true; # Image/video preview\n    gnome.gnome-keyring.enable = true;\n    upower.enable = true; # Power management (required for DMS battery monitoring)\n    smartd = {\n      enable = true;\n      autodetect = true;\n    };\n    pipewire = {\n      enable = true;\n      alsa.enable = true;\n      alsa.support32Bit = true;\n      pulse.enable = true;\n      wireplumber.enable = true; # Enable WirePlumber session manager\n    };\n  };\n}"}
{"p":"modules/core/steam.nix","c":"{ pkgs, ... }:\n{\n  programs = {\n    steam = {\n      enable = true;\n      remotePlay.openFirewall = true;\n      dedicatedServer.openFirewall = false;\n      extraCompatPackages = [ pkgs.proton-ge-bin ];\n      package = pkgs.steam.override {\n        extraPkgs =\n          pkgs: with pkgs; [\n            libusb1\n            udev\n            SDL2\n            xorg.libXcursor\n            xorg.libXi\n            xorg.libXinerama\n            xorg.libXScrnSaver\n            xorg.libXcomposite\n            xorg.libXdamage\n            xorg.libXrender\n            xorg.libXext\n            libkrb5\n            keyutils\n          ];\n      };\n    };\n  };\n  environment.systemPackages = with pkgs; [\n    mangohud\n  ];\n}"}
{"p":"modules/core/stylix.nix","c":"{\n  pkgs,\n  lib,\n  ...\n}: let\n  inherit (import ../../hosts/variables.nix) stylixImage stylixEnable;\nin\nlib.mkIf stylixEnable {\n  stylix = {\n    enable = true;\n    enableReleaseChecks = false;\n    image = stylixImage;\n    polarity = \"dark\";\n    opacity.terminal = 1.0;\n    cursor = {\n      package = pkgs.bibata-cursors;\n      name = \"Bibata-Modern-Ice\";\n      size = 24;\n    };\n    fonts = {\n      monospace = {\n        package = pkgs.nerd-fonts.jetbrains-mono;\n        name = \"JetBrains Mono\";\n      };\n      sansSerif = {\n        package = pkgs.montserrat;\n        name = \"Montserrat\";\n      };\n      serif = {\n        package = pkgs.montserrat;\n        name = \"Montserrat\";\n      };\n      sizes = {\n        applications = 12;\n        terminal = 15;\n        desktop = 11;\n        popups = 12;\n      };\n    };\n  };\n}"}
{"p":"modules/core/system.nix","c":"{ pkgs, ... }:\nlet\n  variables = import ../../hosts/variables.nix;\n  inherit (variables) consoleKeyMap timeZone;\nin\n{\n  nix = {\n    settings = {\n      download-buffer-size = 250000000;\n      auto-optimise-store = true;\n      experimental-features = [\n        \"nix-command\"\n        \"flakes\"\n      ];\n      substituters = [ \"https://hyprland.cachix.org\" ];\n      trusted-public-keys = [ \"hyprland.cachix.org-1:a7pgxzMz7+chwVL3/pzj6jIBMioiJM7ypFP8PwtkuGc=\" ];\n    };\n  };\n  time.timeZone = \"${timeZone}\";\n  i18n.defaultLocale = \"en_US.UTF-8\";\n  programs.nix-ld.enable = true;\n  programs.nix-ld.libraries = with pkgs; [\n    stdenv.cc.cc.lib\n    zlib\n    openssl\n    libGL\n  ];\n  console.keyMap = \"${consoleKeyMap}\";\n  system.stateVersion = \"25.05\";\n}"}
{"p":"modules/core/user.nix","c":"{\n  pkgs,\n  inputs,\n  username,\n  host,\n  profile,\n  ...\n}:\nlet\n  variables = import ../../hosts/variables.nix;\n  inherit (variables) gitUsername;\n  defaultShell = variables.defaultShell or \"zsh\";\n  shellPackage = if defaultShell == \"fish\" then pkgs.fish else pkgs.zsh;\nin\n{\n  imports = [ inputs.home-manager.nixosModules.home-manager ];\n  programs.fish.enable = true;\n  programs.zsh.enable = true;\n  users.groups.i2c = {};\n  home-manager = {\n    useUserPackages = true;\n    useGlobalPkgs = true;\n    backupFileExtension = \"backup\";\n    extraSpecialArgs = {\n      inherit\n        inputs\n        username\n        host\n        profile\n        ;\n    };\n    users.${username} = {\n      imports = [ ./../home ];\n      home = {\n        username = \"${username}\";\n        homeDirectory = \"/home/${username}\";\n        stateVersion = \"25.05\";\n      };\n    };\n  };\n  users.mutableUsers = true;\n  users.users.${username} = {\n    isNormalUser = true;\n    description = \"${gitUsername}\";\n    extraGroups = [\n      \"adbusers\"\n      \"docker\"\n      \"libvirtd\" # For VirtManager\n      \"lp\"\n      \"networkmanager\"\n      \"scanner\"\n      \"wheel\" # sudo access\n      \"vboxusers\" # For VirtualBox\n      \"i2c\"\n    ];\n    shell = shellPackage;\n    ignoreShellProgramCheck = true;\n  };\n  nix.settings.allowed-users = [ \"${username}\" ];\n}"}
{"p":"modules/home/appimage.nix","c":"{ pkgs, ... }:\n{\n  home.packages = [\n    (pkgs.writeShellScriptBin \"envision\" ''\n      ENVISION_CACHE=\"$HOME/.cache/appimages/envision.AppImage\"\n      mkdir -p \"$(dirname \"$ENVISION_CACHE\")\"\n      if [ ! -f \"$ENVISION_CACHE\" ] || [ $(find \"$ENVISION_CACHE\" -mtime +7) ]; then\n        echo \"ðŸ“¦ Downloading Envision AppImage...\"\n        curl -L \"https://gitlab.com/gabmus/envision/-/releases/permalink/latest/downloads/envision.AppImage\" \\\n          -o \"$ENVISION_CACHE\"\n        chmod +x \"$ENVISION_CACHE\"\n      fi\n      exec ${pkgs.appimage-run}/bin/appimage-run \"$ENVISION_CACHE\" \"$@\"\n    '')\n  ];\n}"}
{"p":"modules/home/default.nix","c":"{\n  lib,\n  ...\n}:\nlet\n  variables = import ../../hosts/variables.nix;\n  barChoice = variables.barChoice or \"noctalia\";\n  defaultShell = variables.defaultShell or \"zsh\";\nin\n{\n  imports = [\n    ./appimage.nix\n    ./desktop\n    ./environment.nix\n    ./fzf.nix\n    ./git.nix\n    ./gtk.nix\n    ./kitty.nix\n    ./lazygit.nix\n    ./packages.nix\n    ./qt.nix\n    ./scripts\n    ./starship.nix\n    ./stylix.nix\n    ./theme\n    ./thunar.nix\n    ./zed.nix\n    ./zoxide.nix\n  ]\n  ++ lib.optionals (defaultShell == \"zsh\") [ ./zsh.nix ]\n  ++ lib.optionals (barChoice == \"noctalia\") [ ./noctalia-shell ];\n}"}
{"p":"modules/home/desktop/default.nix","c":"{ ... }:\n{\n  imports = [\n    ./niri\n    ./rofi\n  ];\n}"}
{"p":"modules/home/desktop/niri/default.nix","c":"{ ... }:\n{\n  imports = [\n    ./niri.nix\n  ];\n}"}
{"p":"modules/home/desktop/niri/keybinds.nix","c":"{\n  terminal,\n  browser,\n  hostKeybinds ? \"\",\n  ...\n}:\n''\n  binds {\n      // === Apps ===\n      Mod+Return { spawn \"${terminal}\"; }\n      Mod+B { spawn \"${browser}\"; }\n      Mod+E { spawn \"errands\"; }\n      Mod+Z { spawn \"zeditor\"; }\n      Mod+Space { spawn \"launcher\"; }\n      Ctrl+Q { spawn \"launcher\" \"windows\"; }\n      Mod+Shift+W { spawn \"wall-select\"; }\n      // === Deezer ===\n      XF86AudioRaiseVolume allow-when-locked=true { spawn \"playerctl\" \"--player=Deezer\" \"volume\" \"0.05+\"; }\n      XF86AudioLowerVolume allow-when-locked=true { spawn \"playerctl\" \"--player=Deezer\" \"volume\" \"0.05-\"; }\n      XF86AudioMute        allow-when-locked=true { spawn \"playerctl\" \"--player=Deezer\" \"play-pause\"; }\n      XF86AudioPlay        allow-when-locked=true { spawn \"playerctl\" \"--player=Deezer\" \"play-pause\"; }\n      XF86AudioNext        allow-when-locked=true { spawn \"playerctl\" \"--player=Deezer\" \"next\"; }\n      XF86AudioPrev        allow-when-locked=true { spawn \"playerctl\" \"--player=Deezer\" \"previous\"; }\n      Mod+WheelScrollDown cooldown-ms=50 { spawn \"playerctl\" \"--player=Deezer\" \"volume\" \"0.05-\"; }\n      Mod+WheelScrollUp   cooldown-ms=50 { spawn \"playerctl\" \"--player=Deezer\" \"volume\" \"0.05+\"; }\n      Mod+MouseMiddle     { spawn \"playerctl\" \"--player=Deezer\" \"play-pause\"; }\n      // === Desktop Brightness (Native) ===\n      // Works because Udev attached the driver automatically!\n      Mod+F1 { spawn \"swayosd-client\" \"--brightness\" \"lower\"; }\n      Mod+F2 { spawn \"swayosd-client\" \"--brightness\" \"raise\"; }\n      // === System & Window Management ===\n      Mod+S { screenshot; }\n      Mod+Q { close-window; }\n      Mod+Shift+Q { quit; }\n      Mod+L { spawn \"loginctl\" \"lock-session\"; }\n      Mod+Minus { set-column-width \"33.333%\"; }\n      Mod+Equal { set-column-width \"50%\"; }\n      Mod+BracketLeft { set-column-width \"66.667%\"; }\n      Mod+BracketRight { set-column-width \"100%\"; }\n      Mod+R { switch-preset-column-width; }\n      Mod+F { maximize-column; }\n      Mod+Shift+F { fullscreen-window; }\n      Mod+C { center-column; }\n      Mod+Left  { focus-column-left; }\n      Mod+Right { focus-column-right; }\n      Mod+Shift+Left  { move-column-left; }\n      Mod+Shift+Right { move-column-right; }\n      Mod+Down  { focus-workspace-down; }\n      Mod+Up    { focus-workspace-up; }\n      Mod+Shift+Down  { move-column-to-workspace-down; }\n      Mod+Shift+Up    { move-column-to-workspace-up; }\n      Mod+J     { focus-window-down; }\n      Mod+K     { focus-window-up; }\n      ${hostKeybinds}\n  }\n''"}
{"p":"modules/home/desktop/niri/layout.nix","c":"{ ... }:\n''\n  config-notification {\n      disable-failed\n  }\n  gestures {\n      hot-corners {\n          off\n      }\n  }\n  input {\n      keyboard {\n          xkb {\n          }\n          numlock\n      }\n      touchpad {\n          // Natural scrolling inverts scroll direction\n          // Up swipe scrolls down, down swipe scrolls up (natural direction)\n          natural-scroll\n      }\n      mouse {\n          accel-profile \"adaptive\"\n          accel-speed 1.0\n      }\n      trackpoint {\n      }\n      focus-follows-mouse\n      warp-mouse-to-focus\n  }\n  layout {\n      gaps 9\n      center-focused-column \"never\"\n      always-center-single-column\n      preset-column-widths {\n          proportion 0.33333\n          proportion 0.5\n          proportion 0.66667\n          proportion 1.0\n      }\n      default-column-width { proportion 0.5; }\n      border {\n          width 2\n          active-color \"#cba6f7\"\n          inactive-color \"#45475a\"\n          urgent-color \"#f5c2e7\"\n      }\n      focus-ring {\n          off\n          width 2\n          active-color   \"#808080\"\n          inactive-color \"#505050\"\n      }\n      shadow {\n          softness 30\n          spread 5\n          offset x=0 y=5\n          color \"#0007\"\n      }\n      struts {\n      }\n  }\n  /-layer-rule {\n      match namespace=\"^quickshell$\"\n      place-within-backdrop true\n  }\n  overview {\n      backdrop-color \"#1e1e2e\"\n      workspace-shadow {\n          softness 40\n          spread 10\n          offset x=0 y=10\n          color \"#00000050\"\n      }\n      zoom 0.5\n  }\n  animations {\n      workspace-switch {\n          spring damping-ratio=0.80 stiffness=523 epsilon=0.0001\n      }\n      window-open {\n          duration-ms 150\n          curve \"ease-out-expo\"\n      }\n      window-close {\n          duration-ms 150\n          curve \"ease-out-quad\"\n      }\n      horizontal-view-movement {\n          spring damping-ratio=0.85 stiffness=423 epsilon=0.0001\n      }\n      window-movement {\n          spring damping-ratio=0.75 stiffness=323 epsilon=0.0001\n      }\n      window-resize {\n          spring damping-ratio=0.85 stiffness=423 epsilon=0.0001\n      }\n      config-notification-open-close {\n          spring damping-ratio=0.65 stiffness=923 epsilon=0.001\n      }\n      screenshot-ui-open {\n          duration-ms 200\n          curve \"ease-out-quad\"\n      }\n      overview-open-close {\n          spring damping-ratio=0.85 stiffness=800 epsilon=0.0001\n      }\n  }\n''"}
{"p":"modules/home/desktop/niri/niri.nix","c":"{\n  host,\n  config,\n  pkgs,\n  lib,\n  ...\n}:\nlet\n  variables = import ../../../../hosts/variables.nix;\n  inherit (variables)\n    browser\n    terminal\n    stylixImage\n    startupApps\n    monitorConfig\n    ;\n  barChoice = variables.barChoice or \"waybar\";\n  hostKeybindsPath = ./hosts/${host}/keybinds.nix;\n  hostKeybinds =\n    if builtins.pathExists hostKeybindsPath then import hostKeybindsPath { inherit host; } else \"\";\n  keybindsModule = import ./keybinds.nix {\n    inherit host terminal browser barChoice hostKeybinds config;\n  };\n  windowrulesModule = import ./windowrules.nix { inherit host; };\n  layoutModule = import ./layout.nix { inherit config; };\n  workspacesModule = import ./workspaces.nix { };\n  startupModule = import ./startup.nix {\n    inherit host stylixImage startupApps barChoice pkgs;\n  };\n  hostOutputsPath = ./hosts/${host}/outputs.nix;\n  hostOutputs =\n    if builtins.pathExists hostOutputsPath then\n      import hostOutputsPath { inherit host; }\n    else\n      monitorConfig;\n  hostWindowRulesPath = ./hosts/${host}/windowrules.nix;\n  hostWindowRules =\n    if builtins.pathExists hostWindowRulesPath then\n      import hostWindowRulesPath { inherit host; }\n    else\n      \"\";\n  baseConfig = ''\n    // Niri Configuration for ${host}\n    // Generated by NixOS configuration - BASE PART\n    ${hostOutputs}\n    ${workspacesModule}\n    ${layoutModule}\n    ${keybindsModule}\n    ${windowrulesModule}\n    ${hostWindowRules}\n    ${startupModule}\n    environment {\n          XDG_CURRENT_DESKTOP \"niri\"\n          GTK_USE_PORTAL \"1\"\n          MOZ_ENABLE_WAYLAND \"1\"\n          NIXOS_OZONE_WL \"1\"\n          ELECTRON_OZONE_PLATFORM_HINT \"wayland\"\n          QT_QPA_PLATFORM \"wayland\"\n          QT_QPA_PLATFORMTHEME \"gtk3\"\n          QT_QPA_PLATFORMTHEME_QT6 \"gtk3\"\n          TERMINAL \"${terminal}\"\n          XCURSOR_THEME \"Bibata-Modern-Ice\"\n          XCURSOR_SIZE \"24\"\n          __GL_GSYNC_ALLOWED \"1\"\n          __GL_VRR_ALLOWED \"1\"\n          PROTON_ENABLE_NVAPI \"1\"\n          PROTON_HIDE_NVIDIA_GPU \"0\"\n          PROTON_ENABLE_NGX_UPDATER \"1\"\n    }\n    hotkey-overlay {\n        skip-at-startup\n    }\n    prefer-no-csd\n    screenshot-path \"~/Pictures/Screenshots/Screenshot from %Y-%m-%d %H-%M-%S.png\"\n  '';\nin\n{\n  home.packages = with pkgs; [\n    niri\n    udiskie\n    xwayland-satellite\n    swww\n    grim\n    slurp\n    wl-clipboard\n    swappy\n  ];\n  xdg.configFile.\"niri/config-base.kdl\".text = baseConfig;\n  systemd.user.services.niri-config-assembler = {\n    Unit = {\n      Description = \"Assemble Niri Config (Base + Colors)\";\n      Before = [ \"graphical-session.target\" ];\n    };\n    Service = {\n      Type = \"oneshot\";\n      ExecStart = pkgs.writeShellScript \"assemble-niri-config\" ''\n        BASE=\"$HOME/.config/niri/config-base.kdl\"\n        COLORS=\"$HOME/.config/niri/colors.kdl\"\n        FINAL=\"$HOME/.config/niri/config.kdl\"\n        if [ ! -f \"$COLORS\" ]; then\n          mkdir -p \"$(dirname \"$COLORS\")\"\n          echo \"// Fallback Colors\" > \"$COLORS\"\n          echo \"window-rule { border { active-color \\\"#ff0000\\\"; } }\" >> \"$COLORS\"\n        fi\n        cat \"$BASE\" \"$COLORS\" > \"$FINAL\"\n      '';\n    };\n    Install.WantedBy = [ \"graphical-session.target\" ];\n  };\n  home.activation.setupNiriConfig = lib.hm.dag.entryAfter [ \"writeBoundary\" ] ''\n    $DRY_RUN_CMD ${pkgs.systemd}/bin/systemctl --user start niri-config-assembler.service\n  '';\n  systemd.user.targets.niri-session = {\n    Unit = {\n      Description = \"Niri compositor session\";\n      BindsTo = \"graphical-session.target\";\n      Wants = \"graphical-session-pre.target\";\n      After = \"graphical-session-pre.target\";\n    };\n  };\n  systemd.user.services.waybar-niri = lib.mkIf (barChoice == \"waybar\") {\n    Unit = {\n      Description = \"Waybar status bar\";\n      PartOf = \"graphical-session.target\";\n      ConditionEnvironment = \"XDG_CURRENT_DESKTOP=niri\";\n    };\n    Service = {\n      ExecStart = \"${pkgs.waybar}/bin/waybar\";\n      Restart = \"on-failure\";\n    };\n    Install.WantedBy = [ \"graphical-session.target\" ];\n  };\n  systemd.user.services.xwayland-satellite = {\n    Unit = {\n      Description = \"Xwayland outside Wayland\";\n      BindsTo = \"graphical-session.target\";\n      After = \"graphical-session.target\";\n    };\n    Service = {\n      Type = \"notify\";\n      NotifyAccess = \"all\";\n      ExecStart = \"${pkgs.xwayland-satellite}/bin/xwayland-satellite\";\n      StandardOutput = \"journal\";\n      Restart = \"on-failure\";\n    };\n    Install.WantedBy = [ \"graphical-session.target\" ];\n  };\n  home.file = {\n    \"Pictures/Wallpapers\" = {\n      source = ../../../../wallpapers;\n      recursive = true;\n    };\n  };\n}"}
{"p":"modules/home/desktop/niri/startup.nix","c":"{\n  pkgs,\n  stylixImage,\n  barChoice,\n  ...\n}:\nlet\n  barStartupCommand =\n    if barChoice == \"noctalia\" then\n      ''spawn-at-startup \"noctalia-shell\"''\n    else\n      ''// ${barChoice} started via systemd service'';\n  polkitAgent = \"${pkgs.mate.mate-polkit}/libexec/polkit-mate-authentication-agent-1\";\n  updateEnv = pkgs.writeShellScript \"niri-env-update\" ''\n    export XDG_CURRENT_DESKTOP=niri\n    export XDG_SESSION_DESKTOP=niri\n    export XDG_SESSION_TYPE=wayland\n    ${pkgs.dbus}/bin/dbus-update-activation-environment --systemd \\\n      XDG_CURRENT_DESKTOP \\\n      XDG_SESSION_DESKTOP \\\n      XDG_SESSION_TYPE \\\n      WAYLAND_DISPLAY\n    ${pkgs.systemd}/bin/systemctl --user import-environment \\\n      XDG_CURRENT_DESKTOP \\\n      XDG_SESSION_DESKTOP \\\n      XDG_SESSION_TYPE \\\n      WAYLAND_DISPLAY\n  '';\nin\n''\n  // 1. Run the Environment Fix script immediately\n  spawn-at-startup \"${updateEnv}\"\n  // 2. Start Polkit (Password prompts)\n  spawn-at-startup \"${polkitAgent}\"\n  // 3. Start SwayOSD Server (The background worker)\n  spawn-at-startup \"swayosd-server\"\n  // 4. Desktop Components\n  spawn-at-startup \"bash\" \"-c\" \"wl-paste --watch cliphist store &\"\n  spawn-at-startup \"bash\" \"-c\" \"swww-daemon && sleep 1 && swww img '${stylixImage}'\"\n  ${barStartupCommand}\n  spawn-at-startup \"wal\" \"-R\"\n  // 5. Apps (Apps will trigger the portal restart automatically now)\n  spawn-at-startup \"vivaldi\"\n  spawn-at-startup \"corectrl\"\n  spawn-at-startup \"bash\" \"-c\" \"deezer-enhanced --ozone-platform=wayland & sleep 2; vesktop &\"\n''"}
{"p":"modules/home/desktop/niri/windowrules.nix","c":"{ ... }:\n''\n  // --- Global Look ---\n  window-rule {\n      geometry-corner-radius 12\n      clip-to-geometry true\n      draw-border-with-background false\n  }\n  // --- Rofi Specific Rule (Shadows & Floating) ---\n  window-rule {\n      match app-id=\"^rofi$\"\n      open-floating true\n      shadow {\n          on\n          softness 30\n          spread 10\n          color \"#00000080\"\n      }\n  }\n  // --- ERRANDS (Floating & Centered) ---\n  window-rule {\n      match app-id=r#\"^errands$|^io\\.github\\\\.mrvladus\\\\.List$\"#\n      open-floating true\n      default-column-width { proportion 0.4; }\n      default-window-height { proportion 0.6; }\n  }\n  // --- Workspace 1 Rules (Browser) ---\n  window-rule {\n      match at-startup=true app-id=r#\"^vivaldi.*$\"#\n      open-on-workspace \"1\"\n      default-column-width { proportion 0.66667; }\n  }\n  // --- ZED EDITOR ---\n  window-rule {\n      match app-id=r#\"^dev\\\\.zed\\\\.Zed$\"#\n      default-column-width { proportion 0.33333; }\n  }\n  // --- Workspace 2 Rules (Music/Chat) ---\n  window-rule {\n      match at-startup=true app-id=\"deezer-enhanced\"\n      open-on-workspace \"2\"\n      default-column-width { proportion 0.33333; }\n  }\n  window-rule {\n      match at-startup=true app-id=\"vesktop\"\n      open-on-workspace \"2\"\n      default-column-width { proportion 0.66667; }\n  }\n''"}
{"p":"modules/home/desktop/niri/workspaces.nix","c":"{ ... }:\n''\n  // Declare named workspaces so they exist at startup\n  // This allows open-on-workspace rules to work reliably\n  workspace \"1\" {\n      // You can pin this to a monitor if you have multiple\n      // open-on-output \"DP-1\"\n  }\n  workspace \"2\" {\n      // open-on-output \"DP-1\"\n  }\n''"}
{"p":"modules/home/desktop/rofi/config/WallSelect.rasi","c":"/* ===========================================================================\n   WallSelect.rasi - Visual Wallpaper Selector Theme\n   ===========================================================================\n   Purpose: Creates a horizontal scrolling \"card\" layout for wallpaper previews.\n   Color scheme is imported from Matugen-generated colors.rasi.\n   =========================================================================== */\n/* Import color variables (background, foreground, selected, etc.) */\n@import \"colors.rasi\"\n/* ===========================================================================\n   CONFIGURATION VARIABLES\n   Adjust these values to fine-tune the layout without hunting through the code.\n   =========================================================================== */\n* {\n    /* -- Dimensions --\n       These MUST match the thumbnail generation geometry in scripts.nix.\n       Script uses: WIDTH=415, HEIGHT=550 (3:4 portrait aspect ratio).\n       If you change the script, update these values and recalculate window width. */\n    var-preview-height:          550px;  /* Height of the thumbnail image */\n    var-preview-width:           415px;  /* Width of the thumbnail image */\n    /* -- Spacing --\n       Controls gaps between cards and between cards and window edges.\n       Use the SAME value for consistent inner/outer spacing. */\n    var-gap-size:                25px;   /* Space around and between cards */\n    /* -- Card Padding --\n       Controls the \"fatness\" of the selector. Smaller = tighter fit.\n       This is the space between the image/text and the card's colored border. */\n    var-item-padding:            10px;   /* REDUCED from 15px for slimmer cards */\n    /* -- Window Height --\n       Calculation: preview height + space for text + card padding + window padding.\n       Increase if text is clipped; decrease for tighter fit. */\n    var-window-height:           650px;  /* Total height of the Rofi window */\n}\n/* ===========================================================================\n   WINDOW STYLE\n   The outer container for the entire selector.\n   =========================================================================== */\nwindow {\n    /* Make window see-through (requires compositor like Picom/Hyprland) */\n    transparency:                \"real\";\n    /* Center window on screen */\n    location:                    center;\n    anchor:                      center;\n    /* -- FIXED WIDTH CALCULATION --\n       We MUST use a hardcoded pixel value because Rofi's calc() doesn't support variables.\n       Formula: (var-preview-width * number of columns) + (var-gap-size * (columns + 1))\n       Example: (415px * 5) + (25px * 6) = 2075 + 150 = 2225px\n       This ensures exactly 5 cards with equal gaps on all sides. */\n    width:                       2225px;  /* CALCULATED: DO NOT EDIT DIRECTLY */\n    height:                      @var-window-height;\n    /* Window border and background */\n    enabled:                     true;\n    margin:                      0px;\n    padding:                     0px;\n    border:                      0px solid;\n    border-radius:               16px;    /* Rounded corners for the overall window */\n    background-color:            @background;\n    cursor:                      \"default\";\n}\n/* ===========================================================================\n   MAINBOX (CONTENT CONTAINER)\n   Holds the listview and applies the outermost padding inside the window.\n   =========================================================================== */\nmainbox {\n    enabled:                     true;\n    margin:                      0px;\n    background-color:            transparent; /* Let window background show through */\n    children:                    [ \"listview\" ];\n    /* Apply uniform padding around the entire grid of cards.\n       This creates equal \"dead space\" at window edges: top, right, bottom, left. */\n    padding:                     @var-gap-size;\n}\n/* ===========================================================================\n   LISTVIEW (GRID CONTAINER)\n   Configures the horizontal flow and layout of the cards.\n   =========================================================================== */\nlistview {\n    enabled:                     true;\n    columns:                     5;       /* Show exactly 5 items per row */\n    lines:                       1;       /* Single row for horizontal scrolling */\n    /* Behavior: enable cycling, dynamic loading, no scrollbar */\n    cycle:                       true;\n    dynamic:                     true;\n    scrollbar:                   false;\n    /* Layout: horizontal flow (left-to-right) */\n    layout:                      vertical;\n    flow:                        horizontal;\n    reverse:                     false;\n    fixed-height:                true;\n    fixed-columns:               true;\n    /* Space between individual cards (horizontal gap) */\n    spacing:                     @var-gap-size;\n    background-color:            transparent;\n    text-color:                  @foreground;\n    cursor:                      \"default\";\n}\n/* ===========================================================================\n   ELEMENT (INDIVIDUAL CARD)\n   The \"card\" that holds each wallpaper preview and its filename.\n   This is the \"purple selector\" when in selected state.\n   =========================================================================== */\nelement {\n    enabled:                     true;\n    orientation:                 vertical; /* Stack image above text */\n    /* -- FIXED WIDTH --\n       Forces each card to be exactly as wide as the preview image.\n       This prevents resizing and ensures perfect alignment. */\n    width:                       @var-preview-width;\n    /* -- INTERNAL PADDING (Fatness) --\n       Space between card border and its content (image/text).\n       REDUCED to 10px to make the pink selector less \"fat\". */\n    padding:                     @var-item-padding;\n    /* -- ROUNDED CORNERS FOR CARD --\n       This rounds the selector's background (the pink highlight).\n       To also round the IMAGE inside, see element-icon below. */\n    border-radius:               12px;    /* Rounded corners for the card */\n    /* Colors and interaction */\n    background-color:            transparent; /* Default: no background */\n    text-color:                  @foreground;\n    cursor:                      pointer;\n}\n/* -- Element States --\n   Define styles for normal, alternate (unused here), and selected cards.\n   The \"pink\" selector is element selected.normal. */\n/* Unselected cards (default state) */\nelement normal.normal {\n    background-color:            transparent; /* Invisible background */\n    text-color:                  @foreground;\n}\n/* Alternate rows (optional, kept transparent for consistent look) */\nelement alternate.normal {\n    background-color:            transparent;\n    text-color:                  @foreground;\n}\n/* SELECTED CARD (the \"purple/pink selector\") */\nelement selected.normal {\n    background-color:            @selected;   /* Pink/purple highlight color */\n    text-color:                  @text-selected; /* Text color on highlight */\n}\n/* ===========================================================================\n   ELEMENT-ICON (WALLPAPER THUMBNAIL)\n   The actual image preview. We want this to have rounded corners too.\n   =========================================================================== */\nelement-icon {\n    /* Set image size to match our thumbnail generation */\n    size:                        @var-preview-height;\n    /* -- ROUNDED IMAGE CORNERS --\n       WARNING: This may not clip the image in all Rofi versions.\n       It draws rounded corners on the icon widget's background, but the image\n       might bleed over. In practice, with transparent backgrounds, it often\n       creates the *visual effect* of rounded corners. If you see square corners,\n       this is a Rofi limitation. Generating rounded thumbnails is an alternative. */\n    border-radius:               8px;       /* Smaller radius than the card */\n    cursor:                      inherit;   /* Use parent's pointer cursor */\n    background-color:            transparent;\n    text-color:                  inherit;   /* Inherit text color (unused here) */\n    horizontal-align:            0.5;       /* Center horizontally */\n}\n/* ===========================================================================\n   ELEMENT-TEXT (WALLPAPER FILENAME)\n   The text label under each preview.\n   =========================================================================== */\nelement-text {\n    /* -- BALANCED INTERNAL SPACING --\n       We want equal visual space ABOVE the image and BELOW the text.\n       The card's top/bottom padding handles most of this.\n       This 5px top margin adds a small gap between image and text.\n       It was reduced from 10px to balance the \"dead space\" better. */\n    margin:                      5px 0px 0px 0px; /* Top: 5px, Others: 0px */\n    /* Align text horizontally and vertically */\n    vertical-align:              0.5;       /* Center vertically in its box */\n    horizontal-align:            0.5;       /* Center horizontally */\n    /* Inherit styles from parent */\n    cursor:                      inherit;\n    background-color:            transparent;\n    text-color:                  inherit;\n}"}
{"p":"modules/home/desktop/rofi/config/launcher.rasi","c":"/* ===========================================================================\n   Rofi Theme - Compact & Most Used\n   =========================================================================== */\n@import \"colors.rasi\"\n/* --- Configuration --- */\nconfiguration {\n    show-icons:                 true;\n    drun-display-format:        \"{name}\";\n    /* SORTING: Enable history so used apps float to top */\n    disable-history:            false;\n    sort:                       true;\n    sorting-method:             \"fzf\";\n    matching:                   \"fuzzy\";\n    /* Bindings */\n    kb-mode-next:               \"Control+Tab\";\n    kb-mode-prev:               \"Control+Shift+Tab\";\n}\n/* --- Global Properties --- */\n* {\n    background-color:            transparent;\n    text-color:                  @foreground;\n    margin:                      0px;\n    padding:                     0px;\n    spacing:                     0px;\n}\n/* --- Window --- */\nwindow {\n    /* Compact Sizing (Matches wall-select height) */\n    width:                       1000px;\n    height:                      650px;\n    location:                    center;\n    anchor:                      center;\n    background-color:            @background;\n    border-radius:               16px;\n    /* Safe Border */\n    border:                      2px;\n    border-color:                @selected;\n    cursor:                      \"default\";\n}\nmainbox {\n    orientation:                 horizontal;\n    children:                    [ \"left-area\", \"right-area\" ];\n    background-color:            transparent;\n}\n/* ===========================================================================\n   LEFT AREA (Wallpaper + Button Bar)\n   =========================================================================== */\nleft-area {\n    /* Smaller sidebar width */\n    width:                       380px;\n    expand:                      false;\n    /* Wallpaper */\n    background-image:            url(\"~/.cache/rofi-launcher.jpg\", height);\n    /* Layout: Push mode-switcher to bottom */\n    orientation:                 vertical;\n    children:                    [ \"dummy\", \"mode-switcher\" ];\n    padding:                     20px;\n}\ndummy {\n    expand:                      true;\n    background-color:            transparent;\n}\n/* The Button Bar */\nmode-switcher {\n    orientation:                 horizontal;\n    enabled:                     true;\n    spacing:                     8px;           /* Reduced from 20px */\n    background-color:            @background;\n    text-color:                  @foreground;\n    opacity:                     0.9;\n    padding:                     4px;           /* Reduced from 10px */\n    border-radius:               8px;           /* Reduced from 12px */\n}\nbutton {\n    padding:                     6px 12px;      /* Smaller padding */\n    border-radius:               6px;           /* Reduced from 8px */\n    background-color:            transparent;\n    text-color:                  @foreground-muted;\n    cursor:                      pointer;\n    font:                        \"Sans 9\";      /* Smaller font */\n}\nbutton selected {\n    background-color:            @selected;\n    text-color:                  @text-selected;\n}\n/* ===========================================================================\n   RIGHT AREA (App Grid)\n   =========================================================================== */\nright-area {\n    expand:                      true;\n    orientation:                 vertical;\n    children:                    [ \"inputbar\", \"listview\" ];\n    padding:                     30px;\n    spacing:                     20px;\n    background-color:            @background;\n}\ninputbar {\n    padding:                     12px;\n    border-radius:               12px;\n    background-color:            @background-alt;\n    text-color:                  @foreground;\n    children:                    [ \"entry\" ];\n}\nentry {\n    placeholder:                 \"Search apps...\";\n    placeholder-color:           @foreground-muted;\n    text-color:                  @foreground;\n    cursor:                      text;\n    vertical-align:              0.5;\n}\nlistview {\n    /* COMPACT GRID */\n    columns:                     4;\n    lines:                       3;\n    cycle:                       true;\n    dynamic:                     true;\n    scrollbar:                   false;\n    spacing:                     15px;\n}\n/* ===========================================================================\n   GRID ELEMENTS\n   =========================================================================== */\nelement {\n    /* Vertical: Icon Top, Text Bottom */\n    orientation:                 vertical;\n    padding:                     15px;\n    border-radius:               16px;\n    cursor:                      pointer;\n    spacing:                     8px;\n}\nelement selected {\n    background-color:            @selected;\n    text-color:                  @text-selected;\n}\nelement-icon {\n    /* Slightly smaller icons for compact look */\n    size:                        58px;\n    horizontal-align:            0.5;\n    background-color:            transparent;\n    cursor:                      inherit;\n}\nelement-icon {\n    size:                        48px;  /* MAKE THIS LARGER IF ICONS ARE HIDDEN */\n    horizontal-align:            0.5;\n    background-color:            transparent;\n}\nelement-text {\n    markup:                      true;\n    horizontal-align:            0.5;\n    vertical-align:              0.5;\n    background-color:            transparent;\n    text-color:                  inherit;\n    font:                        \"Sans 10\";\n}"}
{"p":"modules/home/desktop/rofi/default.nix","c":"{ ... }:\n{\n  imports = [\n    ./rofi.nix\n    ./launcher.nix\n    ./niri-kill.nix\n  ];\n}"}
{"p":"modules/home/desktop/rofi/launcher.nix","c":"{ pkgs, config, lib, ... }:\nlet\n  rofiBg = \"${config.home.homeDirectory}/.cache/rofi-launcher.jpg\";\nin\n{\n  home.packages = [\n    (pkgs.writeShellScriptBin \"launcher\" ''\n      set -e\n      if [ ! -f \"${rofiBg}\" ]; then\n        ${pkgs.imagemagick}/bin/convert \"${config.stylix.image}\" -resize ^400x650 -gravity center -extent 400x650 \"${rofiBg}\"\n      fi\n      MODE=\"${\"\\$1\"}\"\n      if [ -z \"$MODE\" ]; then MODE=\"drun\"; fi\n      ${pkgs.rofi}/bin/rofi \\\n        -show \"$MODE\" \\\n        -theme \"${config.home.homeDirectory}/.config/rofi/launcher.rasi\" \\\n        -modes \"drun,windows:rofi-niri-kill,filebrowser\" \\\n        -display-drun \"Apps\" \\\n        -display-windows \"Kill\" \\\n        -display-filebrowser \"Files\" \\\n        -markup-rows \\\n        -kb-mode-next \"Control+Tab\" \\\n        -kb-mode-prev \"Control+Shift+Tab\"\n    '')\n  ];\n  xdg.configFile.\"rofi/launcher.rasi\".source = ./config/launcher.rasi;\n  home.activation.setupWallpaperCache = lib.hm.dag.entryAfter [ \"writeBoundary\" ] ''\n    if [ ! -f \"${rofiBg}\" ]; then\n      echo \"Initializing Rofi Sidebar...\"\n      ${pkgs.imagemagick}/bin/convert \"${config.stylix.image}\" -resize ^400x650 -gravity center -extent 400x650 \"${rofiBg}\"\n    fi\n  '';\n}"}
{"p":"modules/home/desktop/rofi/niri-kill.nix","c":"{ pkgs, ... }:\n{\n  home.packages = [\n    (pkgs.writeScriptBin \"rofi-niri-kill\" ''\n      export LC_ALL=C.UTF-8\n      if [ -n \"''${ROFI_INFO:-}\" ]; then\n        ${pkgs.niri}/bin/niri msg action close-window --id \"$ROFI_INFO\"\n        exit 0\n      fi\n      ${pkgs.niri}/bin/niri msg -j windows 2>/dev/null | \\\n      ${pkgs.jq}/bin/jq -r '.[] | select(.app_id != null) | \"\\(.id)\\t\\(.app_id)\"' | \\\n      while IFS=$'\\t' read -r id app; do\n        [ -z \"$id\" ] && continue\n        case \"$app\" in\n          xwayland-satellite|swappy|grim|slurp|wl-clipboard|cliphist|swayosd*|udiskie|swww*|polkit*|waybar) continue ;;\n        esac\n        name=\"$app\"\n        icon=\"application-x-executable\"\n        case \"$app\" in\n          \"dev.zed.Zed\") name=\"Zed\"; icon=\"zed\" ;;\n          \"kitty\")       name=\"Kitty\"; icon=\"kitty\" ;;\n          \"vesktop\")     name=\"Discord\"; icon=\"discord\" ;;\n          \"vivaldi-stable\") name=\"Vivaldi\"; icon=\"vivaldi\" ;;\n          \"deezer-enhanced\") name=\"Deezer\"; icon=\"deezer\" ;;\n        esac\n        printf \"%s\\0icon\\037%s\\037info\\037%s\\n\" \"$name\" \"$icon\" \"$id\"\n      done || true\n    '')\n    pkgs.jq\n  ];\n}"}
{"p":"modules/home/desktop/rofi/rofi.nix","c":"{ pkgs, ... }:\n{\n  home.packages = [ pkgs.rofi ];\n  xdg.configFile.\"rofi/config.rasi\".source = ./config/launcher.rasi;\n}"}
{"p":"modules/home/environment.nix","c":"{ ... }:\n{\n  home.sessionVariables = {\n    BROWSER = \"xdg-open\";\n    EDITOR = \"zeditor\";\n    TERMINAL = \"kitty\";\n    NIXOS_OZONE_WL = \"1\";\n    MOZ_ENABLE_WAYLAND = \"1\";\n    ELECTRON_OZONE_PLATFORM_HINT = \"wayland\";\n    XDG_CURRENT_DESKTOP = \"niri\";\n    XDG_SESSION_DESKTOP = \"niri\";\n    XDG_SESSION_TYPE = \"wayland\";\n    GTK_USE_PORTAL = \"1\";\n    QT_QPA_PLATFORM = \"wayland\";\n    _JAVA_AWT_WM_NONREPARENTING = \"1\";\n    FONTCONFIG_FILE = \"/etc/fonts/fonts.conf\";\n  };\n}"}
{"p":"modules/home/fzf.nix","c":"{\n  config,\n  lib,\n  ...\n}: let\n  accent = \"#\" + config.lib.stylix.colors.base0D;\n  foreground = \"#\" + config.lib.stylix.colors.base05;\n  muted = \"#\" + config.lib.stylix.colors.base03;\nin {\n  programs.fzf = {\n    enable = true;\n    enableZshIntegration = true;\n    enableFishIntegration = true;\n    colors = lib.mkForce {\n      \"fg+\" = accent;\n      \"bg+\" = \"-1\";\n      \"fg\" = foreground;\n      \"bg\" = \"-1\";\n      \"prompt\" = muted;\n      \"pointer\" = accent;\n    };\n    defaultOptions = [\n      \"--margin=1\"\n      \"--layout=reverse\"\n      \"--border=none\"\n      \"--info='hidden'\"\n      \"--header=''\"\n      \"--prompt='--> '\"\n      \"-i\"\n      \"--no-bold\"\n      \"--bind='enter:execute(nvim {})'\"\n      \"--preview='bat --style=numbers --color=always --line-range :500 {}'\"\n      \"--preview-window=right:60%:wrap\"\n    ];\n  };\n}"}
{"p":"modules/home/git.nix","c":"{host, ...}: let\n  inherit (import ../../hosts/variables.nix) gitUsername gitEmail;\nin {\n  programs.git = {\n    enable = true;\n    settings = {\n      user = {\n        name = \"${gitUsername}\";\n        email = \"${gitEmail}\";\n      };\n      push.default = \"simple\"; # Match modern push behavior\n      credential.helper = \"cache --timeout=7200\";\n      init.defaultBranch = \"main\"; # Set default new branches to 'main'\n      log.decorate = \"full\"; # Show branch/tag info in git log\n      log.date = \"iso\"; # ISO 8601 date format\n      merge.conflictStyle = \"diff3\";\n      alias = {\n        br = \"branch --sort=-committerdate\";\n        co = \"checkout\";\n        df = \"diff\";\n        com = \"commit -a\";\n        gs = \"stash\";\n        gp = \"pull\";\n        lg = \"log --graph --pretty=format:'%Cred%h%Creset - %C(yellow)%d%Creset %s %C(green)(%cr)%C(bold blue) <%an>%Creset' --abbrev-commit\";\n        st = \"status\";\n      };\n    };\n  };\n}"}
{"p":"modules/home/gtk.nix","c":"{ pkgs, ... }:\n{\n  gtk = {\n    enable = true;\n    iconTheme = {\n      name = \"Tela-purple-dark\";\n      package = pkgs.tela-icon-theme;\n    };\n    gtk3.extraConfig = {\n      gtk-application-prefer-dark-theme = 1;\n    };\n    gtk4.extraConfig = {\n      gtk-application-prefer-dark-theme = 1;\n    };\n  };\n}"}
{"p":"modules/home/kitty.nix","c":"{ pkgs, host, ... }:\nlet\n  variables = import ../../hosts/variables.nix;\n  defaultShell = variables.defaultShell or \"zsh\";\n  shellPackage = if defaultShell == \"fish\" then pkgs.fish else pkgs.zsh;\nin\n{\n  programs.kitty = {\n    enable = true;\n    package = pkgs.kitty;\n    settings = {\n      shell = \"${shellPackage}/bin/${defaultShell}\";\n      font_size = 12;\n      font_family = \"JetBrains Mono\";\n      window_padding_width = 4;\n      confirm_os_window_close = 0;\n      enable_audio_bell = false;\n      cursor_trail = 1;\n      allow_remote_control = \"yes\";\n      listen_on = \"unix:@mykitty\";\n      include = \"~/.cache/wal/colors-kitty.conf\";\n    };\n    extraConfig = ''\n      map ctrl+shift+t new_tab\n      map ctrl+shift+q close_tab\n      map alt+n new_os_window\n      map alt+w close_window\n    '';\n  };\n}"}
{"p":"modules/home/lazygit.nix","c":"{ config, lib, ... }:\nlet\n  accent = \"#${config.lib.stylix.colors.base0D}\";\n  muted = \"#${config.lib.stylix.colors.base03}\";\nin {\n  programs.lazygit = {\n    enable = true;\n    settings = lib.mkForce {\n      disableStartupPopups = true;\n      notARepository = \"skip\";\n      promptToReturnFromSubprocess = false;\n      update.method = \"never\";\n      git = {\n        commit.signOff = true;\n        parseEmoji = true;\n      };\n      gui = {\n        theme = {\n          activeBorderColor = [ accent \"bold\" ];\n          inactiveBorderColor = [ muted ];\n        };\n        showListFooter = false;\n        showRandomTip = false;\n        showCommandLog = false;\n        showBottomLine = false;\n        nerdFontsVersion = \"3\";\n      };\n    };\n  };\n}"}
{"p":"modules/home/noctalia-shell/default.nix","c":"{\n  lib,\n  pkgs,\n  inputs,\n  ...\n}:\nlet\n  variables = import ../../../hosts/variables.nix;\n  barChoice = variables.barChoice or \"waybar\";\n  enableNoctalia = barChoice == \"noctalia\";\nin\n{\n  imports = lib.optionals enableNoctalia [\n    inputs.noctalia.homeModules.default\n  ];\n  config = lib.mkIf enableNoctalia {\n    programs.waybar.enable = lib.mkForce false;\n    home.packages = [ inputs.noctalia.packages.${pkgs.system}.default ];\n    home.file.\".config/noctalia/settings.json.template\" = {\n      text = builtins.toJSON {\n        appLauncher = {\n          backgroundOpacity = 1;\n          enableClipboardHistory = false;\n          pinnedExecs = [ ];\n          position = \"center\";\n          sortByMostUsed = true;\n          terminalCommand = \"xterm -e\";\n          useApp2Unit = false;\n        };\n        audio = {\n          cavaFrameRate = 60;\n          mprisBlacklist = [ ];\n          preferredPlayer = \"\";\n          visualizerType = \"linear\";\n          volumeOverdrive = false;\n          volumeStep = 5;\n        };\n        bar = {\n          backgroundOpacity = 1;\n          density = \"default\";\n          floating = false;\n          marginHorizontal = 0.25;\n          marginVertical = 0.25;\n          monitors = [ ];\n          position = \"top\";\n          showCapsule = true;\n          widgets = {\n            center = [\n              {\n                customFont = \"\";\n                formatHorizontal = \"h:mm AP, MMM dd\";\n                formatVertical = \"HH mm - dd MM\";\n                id = \"Clock\";\n                useCustomFont = false;\n                usePrimaryColor = true;\n              }\n            ];\n            left = [\n              {\n                hideUnoccupied = false;\n                id = \"Workspace\";\n                labelMode = \"index\";\n              }\n              {\n                colorizeIcons = false;\n                hideMode = \"hidden\";\n                id = \"ActiveWindow\";\n                maxWidth = 145;\n                scrollingMode = \"hover\";\n                showIcon = true;\n                useFixedWidth = false;\n              }\n              {\n                hideMode = \"hidden\";\n                id = \"MediaMini\";\n                maxWidth = 145;\n                scrollingMode = \"hover\";\n                showAlbumArt = false;\n                showVisualizer = false;\n                useFixedWidth = false;\n                visualizerType = \"linear\";\n              }\n            ];\n            right = [\n              {\n                blacklist = [ ];\n                colorizeIcons = false;\n                id = \"Tray\";\n              }\n              {\n                id = \"SystemMonitor\";\n                showCpuTemp = true;\n                showCpuUsage = true;\n                showDiskUsage = false;\n                showMemoryAsPercent = false;\n                showMemoryUsage = true;\n                showNetworkStats = false;\n              }\n              {\n                hideWhenZero = true;\n                id = \"NotificationHistory\";\n                showUnreadBadge = true;\n              }\n              {\n                displayMode = \"onhover\";\n                id = \"Volume\";\n              }\n              {\n                customIconPath = \"/home/don/black-don-os/modules/home/fastfetch/blackdontrans.png\";\n                icon = \"noctalia\";\n                id = \"ControlCenter\";\n                useDistroLogo = false;\n              }\n            ];\n          };\n        };\n        battery = {\n          chargingMode = 0;\n        };\n        brightness = {\n          brightnessStep = 5;\n        };\n        colorSchemes = {\n          darkMode = true;\n          generateTemplatesForPredefined = true;\n          manualSunrise = \"06:30\";\n          manualSunset = \"18:30\";\n          matugenSchemeType = \"scheme-fruit-salad\";\n          predefinedScheme = \"Catppuccin\";\n          schedulingMode = \"off\";\n          useWallpaperColors = false;\n        };\n        controlCenter = {\n          cards = [\n            {\n              enabled = true;\n              id = \"profile-card\";\n            }\n            {\n              enabled = true;\n              id = \"shortcuts-card\";\n            }\n            {\n              enabled = true;\n              id = \"audio-card\";\n            }\n            {\n              enabled = true;\n              id = \"weather-card\";\n            }\n            {\n              enabled = true;\n              id = \"media-sysmon-card\";\n            }\n          ];\n          position = \"close_to_bar_button\";\n          shortcuts = {\n            left = [\n              {\n                id = \"WiFi\";\n              }\n              {\n                id = \"Bluetooth\";\n              }\n              {\n                id = \"ScreenRecorder\";\n              }\n              {\n                id = \"WallpaperSelector\";\n              }\n            ];\n            right = [\n              {\n                id = \"Notifications\";\n              }\n              {\n                id = \"PowerProfile\";\n              }\n              {\n                id = \"KeepAwake\";\n              }\n              {\n                id = \"NightLight\";\n              }\n            ];\n          };\n        };\n        dock = {\n          backgroundOpacity = 1;\n          colorizeIcons = true;\n          displayMode = \"exclusive\";\n          floatingRatio = 1;\n          monitors = [ \"DP-1\" ];\n          onlySameOutput = true;\n          pinnedApps = [ ];\n          size = 1;\n        };\n        general = {\n          animationDisabled = false;\n          animationSpeed = 1;\n          avatarImage = \"/home/don/black-don-os/modules/home/fastfetch/blackdontrans.png\";\n          compactLockScreen = false;\n          dimDesktop = true;\n          forceBlackScreenCorners = false;\n          language = \"en\";\n          lockOnSuspend = true;\n          radiusRatio = 0.5;\n          scaleRatio = 1;\n          screenRadiusRatio = 1;\n          showScreenCorners = false;\n        };\n        hooks = {\n          darkModeChange = \"\";\n          enabled = false;\n          wallpaperChange = \"\";\n        };\n        \"location\" = {\n          name = \"Local\";\n          showCalendarEvents = true;\n          showWeekNumberInCalendar = false;\n          use12hourFormat = false;\n          useFahrenheit = false;\n          weatherEnabled = true;\n        };\n        network = {\n          wifiEnabled = true;\n        };\n        nightLight = {\n          autoSchedule = true;\n          dayTemp = \"6500\";\n          enabled = false;\n          forced = false;\n          manualSunrise = \"06:30\";\n          manualSunset = \"18:30\";\n          nightTemp = \"4000\";\n        };\n        notifications = {\n          criticalUrgencyDuration = 15;\n          doNotDisturb = false;\n          \"location\" = \"top_right\";\n          lowUrgencyDuration = 3;\n          monitors = [ ];\n          normalUrgencyDuration = 8;\n          overlayLayer = true;\n          respectExpireTimeout = false;\n        };\n        osd = {\n          autoHideMs = 2000;\n          enabled = true;\n          \"location\" = \"top_right\";\n          monitors = [ ];\n          overlayLayer = true;\n        };\n        screenRecorder = {\n          audioCodec = \"opus\";\n          audioSource = \"default_output\";\n          colorRange = \"limited\";\n          directory = \"\";\n          frameRate = 60;\n          quality = \"very_high\";\n          showCursor = true;\n          videoCodec = \"h264\";\n          videoSource = \"portal\";\n        };\n        settingsVersion = 16;\n        setupCompleted = true;\n        templates = {\n          discord = false;\n          discord_armcord = false;\n          discord_dorion = false;\n          discord_equibop = false;\n          discord_lightcord = false;\n          discord_vesktop = false;\n          discord_webcord = false;\n          enableUserTemplates = false;\n          foot = false;\n          fuzzel = false;\n          ghostty = false;\n          gtk = false;\n          kcolorscheme = false;\n          kitty = false;\n          pywalfox = false;\n          qt = false;\n          vicinae = false;\n        };\n        ui = {\n          fontDefault = \"FiraCode Nerd Font\";\n          fontDefaultScale = 1;\n          fontFixed = \"DejaVu Sans Mono\";\n          fontFixedScale = 1;\n          panelsOverlayLayer = true;\n          tooltipsEnabled = true;\n        };\n        wallpaper = {\n          defaultWallpaper = \"\";\n          directory = \"\";\n          enableMultiMonitorDirectories = false;\n          enabled = true;\n          fillColor = \"#000000\";\n          fillMode = \"crop\";\n          monitors = [ ];\n          randomEnabled = false;\n          randomIntervalSec = 300;\n          setWallpaperOnAllMonitors = true;\n          transitionDuration = 1500;\n          transitionEdgeSmoothness = 0.05;\n          transitionType = \"random\";\n        };\n      };\n    };\n    home.activation.noctaliaSettingsInit = lib.hm.dag.entryAfter [ \"writeBoundary\" ] ''\n      SETTINGS_FILE=\"$HOME/.config/noctalia/settings.json\"\n      TEMPLATE_FILE=\"$HOME/.config/noctalia/settings.json.template\"\n      if [ ! -f \"$SETTINGS_FILE\" ] || [ -L \"$SETTINGS_FILE\" ]; then\n        $DRY_RUN_CMD rm -f \"$SETTINGS_FILE\"\n        $DRY_RUN_CMD cp \"$TEMPLATE_FILE\" \"$SETTINGS_FILE\"\n        $DRY_RUN_CMD chmod 644 \"$SETTINGS_FILE\"\n      fi\n    '';\n    home.activation.noctaliaWarning = lib.hm.dag.entryAfter [ \"noctaliaSettingsInit\" ] ''\n      $DRY_RUN_CMD echo \"\"\n      $DRY_RUN_CMD echo \"â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\"\n      $DRY_RUN_CMD echo \"ðŸŒ™ Noctalia Shell is ENABLED\"\n      $DRY_RUN_CMD echo \"â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\"\n      $DRY_RUN_CMD echo \"\"\n      $DRY_RUN_CMD echo \"âš ï¸  Waybar has been automatically disabled\"\n      $DRY_RUN_CMD echo \"\"\n      $DRY_RUN_CMD echo \"ðŸ“ Configuration: ~/.config/noctalia/settings.json (GUI-editable)\"\n      $DRY_RUN_CMD echo \"ðŸŽ¨ Settings synced from GUI (use ./sync-from-gui.py to update)\"\n      $DRY_RUN_CMD echo \"âœï¸  All GUI changes persist across reboots\"\n      $DRY_RUN_CMD echo \"\"\n      $DRY_RUN_CMD echo \"ðŸ’¡ To update Nix template from GUI changes:\"\n      $DRY_RUN_CMD echo \"   cd modules/home/noctalia-shell && ./sync-from-gui.py\"\n      $DRY_RUN_CMD echo \"\"\n      $DRY_RUN_CMD echo \"ðŸ“š Docs: https://docs.noctalia.dev\"\n      $DRY_RUN_CMD echo \"â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\"\n      $DRY_RUN_CMD echo \"\"\n    '';\n  };\n}"}
{"p":"modules/home/packages.nix","c":"{ pkgs, ... }:\n{\n  home.packages = with pkgs; [\n    vivaldi           # Browser\n    vesktop           # Discord\n    deezer-enhanced   # Music\n    zed-editor        # Code\n    networkmanagerapplet\n    ddcutil           # Monitor control\n    playerctl         # Media keys\n    swayosd           # Volume/brightness OSD\n    brightnessctl\n    xfce.thunar  # File manager\n    xfce.thunar-archive-plugin    # Right-click extract\n    xfce.thunar-volman            # Auto-mount USB\n    xfce.thunar-media-tags-plugin # Audio tags\n    ffmpegthumbnailer             # Video thumbnails\n    file-roller             # Archive GUI\n    ffmpegthumbnailer # Thumbnails\n    grim              # Screenshots\n    slurp             # Area selection\n    wl-clipboard      # Clipboard\n    swappy            # Edit screenshots\n    gemini-cli        # Gemini protocol\n    nvd               # Nix diffs\n    errands           # Todo app\n    github-cli        # Manage Github\n    hyfetch           # Gay flex\n  ];\n}"}
{"p":"modules/home/qt.nix","c":"_: {\n  qt = {\n    enable = true;\n  };\n}"}
{"p":"modules/home/starship.nix","c":"{\n  lib,\n  ...\n}:\nlet\n  variables = import ../../hosts/variables.nix;\n  defaultShell = variables.defaultShell or \"zsh\";\nin\n{\n  programs.starship = {\n    enable = defaultShell != \"fish\";\n    settings = {\n      add_newline = false;\n      format = lib.concatStrings [\n        \"$nix_shell\"\n        \"$hostname\"\n        \"$directory\"\n        \"$git_branch\"\n        \"$git_state\"\n        \"$git_status\"\n        \"\\n\"\n        \"$character\"\n      ];\n      directory = {\n        style = \"bold blue\";\n      };\n      character = {\n        success_symbol = \"[â¯](bold green)\";\n        error_symbol = \"[â¯](bold red)\";\n        vimcmd_symbol = \"[â®](cyan)\";\n      };\n      nix_shell = {\n        format = \"[$symbol]($style) \";\n        symbol = \"ðŸš\";\n        style = \"\";\n      };\n      git_branch = {\n        symbol = \"ï˜ \";\n        style = \"bold purple\";\n        format = \"on [$symbol$branch]($style) \";\n      };\n      git_status = {\n        format = \"[[(*$conflicted$untracked$modified$staged$renamed$deleted)](218)($ahead_behind$stashed)]($style)\";\n        style = \"cyan\";\n        conflicted = \"\";\n        renamed = \"\";\n        deleted = \"\";\n        stashed = \"â‰¡\";\n      };\n      git_state = {\n        format = \"([$state( $progress_current/$progress_total)]($style)) \";\n        style = \"bright-black\";\n      };\n    };\n  };\n}"}
{"p":"modules/home/stylix.nix","c":"{\n  pkgs,\n  lib,\n  ...\n}:\nlet\n  variables = import ../../hosts/variables.nix;\n  inherit (variables) stylixImage stylixEnable;\nin\nlib.mkIf stylixEnable {\n  stylix = {\n    enable = true;\n    image = stylixImage;\n    autoEnable = false;\n    targets.gtk.enable = false;\n    targets.kitty.enable = false;\n    polarity = \"dark\";\n    cursor = {\n      package = pkgs.bibata-cursors;\n      name = \"Bibata-Modern-Ice\";\n      size = 24;\n    };\n    fonts = {\n      monospace = {\n        package = pkgs.nerd-fonts.jetbrains-mono;\n        name = \"JetBrains Mono\";\n      };\n      sansSerif = {\n        package = pkgs.montserrat;\n        name = \"Montserrat\";\n      };\n      serif = {\n        package = pkgs.montserrat;\n        name = \"Montserrat\";\n      };\n      sizes = {\n        applications = 12;\n        terminal = 15;\n        desktop = 11;\n        popups = 12;\n      };\n    };\n  };\n}"}
{"p":"modules/home/theme/default.nix","c":"{ pkgs, ... }:\n{\n  imports = [\n    ./libs/theme-logic.nix  # <--- CHANGED THIS\n  ];\n  home.packages = with pkgs; [\n    swww\n    imagemagick\n    rofi\n    pastel\n    jq\n    gnused\n  ];\n  xdg.configFile = {\n    \"rofi/WallSelect.rasi\".source = ../desktop/rofi/config/WallSelect.rasi;\n  };\n  systemd.user.services.create-theme-dirs = {\n    Unit = { Description = \"Create mutable theme directories\"; };\n    Service = {\n      Type = \"oneshot\";\n      ExecStart = \"${pkgs.bash}/bin/bash -c 'mkdir -p %h/.config/niri %h/.config/rofi %h/.config/zed/themes %h/.config/vesktop/themes %h/.config/kitty %h/.config/gtk-4.0 %h/.config/gtk-3.0 %h/.cache/wal'\";\n    };\n    Install.WantedBy = [ \"default.target\" ];\n  };\n}"}
{"p":"modules/home/theme/libs/palette-gen.sh","c":"if [ -z \"$1\" ]; then echo \"Usage: palette-gen <path/to/image> [--json|--preview]\"; exit 1; fi\nIMG=\"$1\"\nMODE=\"$2\"\nANCHOR_RAW=$(magick \"$IMG\" -scale 1x1! -depth 8 -format \"%[hex:u]\" info: | cut -c1-6)\nif [ -z \"$ANCHOR_RAW\" ]; then ANCHOR=\"#2E3440\"; else ANCHOR=\"#$ANCHOR_RAW\"; fi\nBG=$(pastel color \"$ANCHOR\" | pastel set hsl-saturation 0.15 | pastel set hsl-lightness 0.08 | pastel format hex)\nFG=$(pastel color \"$ANCHOR\" | pastel set hsl-saturation 0.10 | pastel set hsl-lightness 0.90 | pastel format hex)\nFG_DIM=$(pastel color \"$FG\" | pastel darken 0.3 | pastel format hex)\nSEM_RED=$(pastel color \"$ANCHOR\" | pastel set hue 0 | pastel set hsl-saturation 0.90 | pastel set hsl-lightness 0.65 | pastel format hex)\nSEM_GREEN=$(pastel color \"$ANCHOR\" | pastel set hue 120 | pastel set hsl-saturation 0.80 | pastel set hsl-lightness 0.65 | pastel format hex)\nSEM_YELLOW=$(pastel color \"$ANCHOR\" | pastel set hue 50 | pastel set hsl-saturation 0.95 | pastel set hsl-lightness 0.85 | pastel format hex)\nSEM_BLUE=$(pastel color \"$ANCHOR\" | pastel set hue 220 | pastel set hsl-saturation 0.90 | pastel set hsl-lightness 0.70 | pastel format hex)\nSYN_KEY=$(pastel color \"$ANCHOR\" | pastel set hsl-saturation 0.85 | pastel set hsl-lightness 0.70 | pastel format hex)\nSYN_FUN=$(pastel color \"$ANCHOR\" | pastel rotate 30 | pastel set hsl-saturation 0.85 | pastel set hsl-lightness 0.70 | pastel format hex)\nSYN_STR=$(pastel color \"$ANCHOR\" | pastel rotate -- -30 | pastel set hsl-saturation 0.85 | pastel set hsl-lightness 0.75 | pastel format hex)\nSYN_ACC=$(pastel color \"$ANCHOR\" | pastel rotate 150 | pastel set hsl-saturation 0.80 | pastel set hsl-lightness 0.75 | pastel format hex)\nUI_PRIM=$(pastel color \"$ANCHOR\" | pastel set hsl-saturation 0.80 | pastel set hsl-lightness 0.60 | pastel format hex)\nUI_SEC=$(pastel color \"$BG\" | pastel lighten 0.1 | pastel format hex)\nif [ \"$MODE\" == \"--preview\" ]; then\n    p() { printf \"\\x1b[48;2;$(printf \"%d;%d;%d\" 0x${1:1:2} 0x${1:3:2} 0x${1:5:2})m    \\x1b[0m %s\\n\" \"$2\"; }\n    echo \"--- Atmosphere ---\"\n    p \"$BG\" \"BG       (Background)\"\n    p \"$FG\" \"FG       (Foreground)\"\n    echo \"--- Semantics (Fixed) ---\"\n    p \"$SEM_RED\" \"SEM_RED  (Errors)\"\n    p \"$SEM_YELLOW\" \"SEM_YELLOW (Warnings - Fixed!)\"\n    p \"$SEM_GREEN\" \"SEM_GREEN (Success)\"\n    echo \"--- Thematics (Wallpaper) ---\"\n    p \"$SYN_KEY\" \"SYN_KEY  (Keywords)\"\n    p \"$SYN_ACC\" \"SYN_ACC  (Accents)\"\n    echo \"--- UI (Clean) ---\"\n    p \"$UI_PRIM\" \"UI_PRIM  (Active Border)\"\nelse\n    cat <<EOF\nexport ANCHOR=\"$ANCHOR\"\nexport BG=\"$BG\"\nexport FG=\"$FG\"\nexport FG_DIM=\"$FG_DIM\"\nexport SEM_RED=\"$SEM_RED\"\nexport SEM_GREEN=\"$SEM_GREEN\"\nexport SEM_YELLOW=\"$SEM_YELLOW\"\nexport SEM_BLUE=\"$SEM_BLUE\"\nexport SYN_KEY=\"$SYN_KEY\"\nexport SYN_FUN=\"$SYN_FUN\"\nexport SYN_STR=\"$SYN_STR\"\nexport SYN_ACC=\"$SYN_ACC\"\nexport UI_PRIM=\"$UI_PRIM\"\nexport UI_SEC=\"$UI_SEC\"\nEOF\nfi"}
{"p":"modules/home/theme/libs/theme-logic.nix","c":"{ pkgs, config, ... }:\nlet\n  wallDir = \"${config.home.homeDirectory}/Pictures/Wallpapers\";\n  cacheDir = \"${config.home.homeDirectory}/.cache/wall-thumbs\";\n  rofiTheme = \"${config.home.homeDirectory}/.config/rofi/WallSelect.rasi\";\n  paletteGenScript = builtins.readFile ./palette-gen.sh;\nin\n{\n  home.packages = [\n    pkgs.libnotify\n    pkgs.imagemagick\n    pkgs.findutils\n    pkgs.coreutils\n    pkgs.pastel\n    pkgs.jq\n    pkgs.gnused\n    (pkgs.writeShellScriptBin \"palette-gen\" paletteGenScript)\n    (pkgs.writeShellScriptBin \"theme-engine\" ''\n      set -e\n      IMG=\"$1\"\n      echo \"[Engine] Processing: $IMG\"\n      eval \"$(palette-gen \"$IMG\")\"\n      cat <<EOF > \"$HOME/.config/niri/colors.kdl\"\n      // Generated by theme-engine\n      window-rule {\n          border {\n              active-color \"$UI_PRIM\"\n              inactive-color \"$UI_SEC\"\n              width 2\n          }\n      }\n      EOF\n      cat <<EOF > \"$HOME/.config/rofi/colors.rasi\"\n      * {\n          background:     $BG;\n          background-alt: $UI_SEC;\n          foreground:     $FG;\n          selected:       $UI_PRIM;\n          text-selected:  $BG;\n          active:         $SYN_KEY;\n          urgent:         $SEM_RED;\n      }\n      EOF\n      cat <<EOF > \"$HOME/.config/vesktop/themes/lis.theme.css\"\n      /** Generated by theme-engine **/\n      :root {\n          --background-primary: $BG;\n          --background-secondary: $UI_SEC;\n          --background-tertiary: $BG;\n          --text-normal: $FG;\n          --text-muted: $FG_DIM;\n          --header-primary: $SYN_KEY;\n          --interactive-active: $UI_PRIM;\n          --interactive-normal: $FG;\n          --brand-experiment: $UI_PRIM;\n      }\n      EOF\n      cat <<EOF > \"$HOME/.config/gtk-3.0/gtk.css\"\n      @define-color theme_bg_color $BG;\n      @define-color theme_fg_color $FG;\n      @define-color theme_selected_bg_color $UI_PRIM;\n      @define-color theme_selected_fg_color $BG;\n      window { background: $BG; color: $FG; }\n      view { background: $UI_SEC; color: $FG; }\n      headerbar { background: $BG; }\n      EOF\n      cp \"$HOME/.config/gtk-3.0/gtk.css\" \"$HOME/.config/gtk-4.0/gtk.css\"\n      cat <<EOF > \"$HOME/.cache/wal/colors-kitty.conf\"\n      foreground $FG\n      background $BG\n      cursor $UI_PRIM\n      color0 $BG\n      color8 $UI_SEC\n      color1 $SEM_RED\n      color9 $SEM_RED\n      color2 $SEM_GREEN\n      color10 $SEM_GREEN\n      color3 $SEM_YELLOW\n      color11 $SEM_YELLOW\n      color4 $SEM_BLUE\n      color12 $SEM_BLUE\n      color5 $SYN_KEY\n      color13 $SYN_KEY\n      color6 $SYN_FUN\n      color14 $SYN_FUN\n      color7 $FG\n      color15 $FG\n      EOF\n      TEMPLATE=\"$HOME/.config/wal/templates/zed.template\"\n      OUTPUT=\"$HOME/.config/zed/themes/pywal.json\" # Kept filename for compatibility\n      if [ -f \"$TEMPLATE\" ]; then\n        cp \"$TEMPLATE\" \"$OUTPUT\"\n        replace() { sed -i \"s|{$1}|$2|g\" \"$OUTPUT\"; }\n        replace \"bg\" \"$BG\"\n        replace \"fg\" \"$FG\"\n        replace \"fg_dim\" \"$FG_DIM\"\n        replace \"ui_prim\" \"$UI_PRIM\"\n        replace \"ui_sec\" \"$UI_SEC\"\n        replace \"sem_red\" \"$SEM_RED\"\n        replace \"sem_green\" \"$SEM_GREEN\"\n        replace \"sem_yellow\" \"$SEM_YELLOW\"\n        replace \"sem_blue\" \"$SEM_BLUE\"\n        replace \"syn_key\" \"$SYN_KEY\"\n        replace \"syn_fun\" \"$SYN_FUN\"\n        replace \"syn_str\" \"$SYN_STR\"\n        replace \"syn_acc\" \"$SYN_ACC\"\n      fi\n      echo \"[Engine] Configuration Complete.\"\n    '')\n    (pkgs.writeShellScriptBin \"theme-manager\" ''\n      set -e\n      IMG=\"$1\"\n      if [ -z \"$IMG\" ]; then echo \"Usage: theme-manager <path>\"; exit 1; fi\n      if ! pgrep -x swww-daemon > /dev/null; then swww-daemon & sleep 0.5; fi\n      swww img \"$IMG\" --transition-type grow --transition-pos 0.5,0.5 --transition-fps 60 --transition-duration 2\n      ln -sf \"$IMG\" \"$HOME/.cache/current_wallpaper.jpg\"\n      ${pkgs.imagemagick}/bin/magick \"$IMG\" -resize ^640x1080 -gravity center -extent 640x1080 \"$HOME/.cache/rofi-launcher.jpg\" || true\n      theme-engine \"$IMG\"\n      systemctl --user start niri-config-assembler.service\n      niri msg action load-config-file\n      if pgrep -x kitty > /dev/null; then\n          kitty @ --to=unix:@mykitty set-colors -a -c ~/.cache/wal/colors-kitty.conf || true\n      fi\n      notify-send \"Theme Active\" \"$(basename \"$IMG\")\" -i \"$IMG\"\n    '')\n    (pkgs.writeShellScriptBin \"wall-select\" ''\n      THUMB_WIDTH=415\n      THUMB_HEIGHT=550\n      export PATH=${pkgs.imagemagick}/bin:${pkgs.coreutils}/bin:${pkgs.rofi}/bin:${pkgs.findutils}/bin:${pkgs.libnotify}/bin:$PATH\n      export CACHE_DIR=\"${cacheDir}\"\n      mkdir -p \"$CACHE_DIR\"\n      if [ ! -d \"${wallDir}\" ]; then\n        notify-send \"Error\" \"Wallpaper dir missing: ${wallDir}\" -u critical\n        exit 1\n      fi\n      find -L \"${wallDir}\" -type f \\( -iname \"*.jpg\" -o -iname \"*.jpeg\" -o -iname \"*.png\" -o -iname \"*.webp\" \\) -print0 | \\\n      xargs -0 -P $(nproc) -I {} sh -c '\n        img=\"{}\"\n        filename=$(basename \"$img\")\n        cache=\"$CACHE_DIR/$filename\"\n        if [ ! -f \"$cache\" ]; then\n          magick \"$img\" -thumbnail \"415x550^\" -gravity center -extent 415x550 \"$cache\" 2>/dev/null || true\n        fi\n      '\n      SELECTED=$( \\\n        find -L \"${wallDir}\" -type f \\( -iname \"*.jpg\" -o -iname \"*.jpeg\" -o -iname \"*.png\" -o -iname \"*.webp\" \\) -print0 | \\\n        xargs -0 basename -a | \\\n        sort | \\\n        while IFS= read -r filename; do\n            printf \"%s\\0icon\\x1f%s/%s\\n\" \"$filename\" \"$CACHE_DIR\" \"$filename\"\n        done | \\\n        ${pkgs.rofi}/bin/rofi -dmenu -theme \"${rofiTheme}\" -p \"Select Wallpaper\" -show-icons \\\n      )\n      if [ -n \"$SELECTED\" ]; then\n        theme-manager \"${wallDir}/$SELECTED\"\n      fi\n    '')\n  ];\n  xdg.configFile.\"wal/templates/zed.template\".source = ../templates/zed.template;\n}"}
{"p":"modules/home/theme/templates/discord.css","c":"/*\n   Midnight Discord - Matugen Integration\n   Based on: https://github.com/kirisaki-vk/midnight-discord-matugen\n*/\n@import url(\"https://refact0r.github.io/midnight-discord/build/midnight.css\");\n:root {\n    /* Matugen Colors -> Midnight Variables */\n    --primary-100: {{colors.primary.default.hex}};\n    --primary-200: {{colors.primary_container.default.hex}};\n    --primary-300: {{colors.on_primary.default.hex}};\n    --accent-100: {{colors.tertiary.default.hex}};\n    --accent-200: {{colors.tertiary_container.default.hex}};\n    --accent-300: {{colors.on_tertiary.default.hex}};\n    --background-100: {{colors.surface.default.hex}};\n    --background-200: {{colors.surface_container.default.hex}};\n    --background-300: {{colors.surface_container_high.default.hex}};\n    --text-0: {{colors.on_surface.default.hex}};\n    --text-1: {{colors.on_surface_variant.default.hex}};\n    --text-2: {{colors.outline.default.hex}};\n    /* Status Colors */\n    --success: {{colors.primary.default.hex}};\n    --danger: {{colors.error.default.hex}};\n    /* Window Transparency */\n    --window-padding: 20px;\n    --window-roundness: 12px;\n}"}
{"p":"modules/home/theme/templates/gtk.css","c":"@define-color theme_bg_color {{colors.surface.default.hex}};\n@define-color theme_fg_color {{colors.on_surface.default.hex}};\n@define-color theme_selected_bg_color {{colors.primary.default.hex}};\n@define-color theme_selected_fg_color {{colors.on_primary.default.hex}};\n/* Window Backgrounds */\nwindow { background: @theme_bg_color; color: @theme_fg_color; }\nview { background: {{colors.surface_container_lowest.default.hex}}; color: @theme_fg_color; }\nheaderbar { background: {{colors.surface_container.default.hex}}; }\npopover { background: {{colors.surface_container_high.default.hex}}; }"}
{"p":"modules/home/theme/templates/kitty.conf","c":"foreground {{colors.on_surface.default.hex}}\nbackground {{colors.surface_container_lowest.default.hex}}\ncursor {{colors.primary.default.hex}}\nselection_background {{colors.primary.default.hex}}\nselection_foreground {{colors.on_primary.default.hex}}\ncolor0 {{colors.surface_container_high.default.hex}}\ncolor8 {{colors.outline.default.hex}}\ncolor1 {{colors.error.default.hex}}\ncolor9 {{colors.error_container.default.hex}}\ncolor2 {{colors.tertiary.default.hex}}\ncolor10 {{colors.tertiary_container.default.hex}}\ncolor3 {{colors.primary_container.default.hex}}\ncolor11 {{colors.on_primary_container.default.hex}}\ncolor4 {{colors.secondary.default.hex}}\ncolor12 {{colors.secondary_container.default.hex}}\ncolor5 {{colors.primary.default.hex}}\ncolor13 {{colors.on_primary.default.hex}}\ncolor6 {{colors.on_secondary_container.default.hex}}\ncolor14 {{colors.on_secondary.default.hex}}\ncolor7 {{colors.on_surface.default.hex}}\ncolor15 {{colors.inverse_on_surface.default.hex}}\nactive_tab_foreground   {{colors.on_primary.default.hex}}\nactive_tab_background   {{colors.primary.default.hex}}\ninactive_tab_foreground {{colors.on_surface_variant.default.hex}}\ninactive_tab_background {{colors.surface_container.default.hex}}"}
{"p":"modules/home/theme/templates/niri.kdl","c":"// Generated by Matugen\nwindow-rule {\n    border {\n        active-color \"{{colors.primary.default.hex}}\"\n        inactive-color \"{{colors.surface_container_highest.default.hex}}\"\n        width 2\n    }\n}"}
{"p":"modules/home/theme/templates/rofi.rasi","c":"* {\n    background:     {{colors.surface.default.hex}};\n    background-alt: {{colors.surface_container_high.default.hex}};\n    foreground:     {{colors.on_surface.default.hex}};\n    selected:       {{colors.primary.default.hex}};\n    text-selected:  {{colors.on_primary.default.hex}}; /* <--- ADDED THIS */\n    active:         {{colors.tertiary.default.hex}};\n    urgent:         {{colors.error.default.hex}};\n}"}
{"p":"modules/home/theme/templates/zed.template","c":"{\n  \"$schema\": \"https://zed.dev/schema/themes/v0.1.0.json\",\n  \"name\": \"LisTheme\",\n  \"author\": \"Lis\",\n  \"themes\": [\n    {\n      \"name\": \"LisTheme\",\n      \"appearance\": \"dark\",\n      \"style\": {\n        \"border\": \"{ui_sec}\",\n        \"border.variant\": \"{ui_sec}\",\n        \"elevated_surface.background\": \"{bg}\",\n        \"surface.background\": \"{bg}\",\n        \"editor.background\": \"{bg}\",\n        \"editor.foreground\": \"{fg}\",\n        \"editor.active_line.background\": \"{ui_sec}\",\n        \"editor.line_number\": \"{fg_dim}\",\n        \"editor.active_line_number\": \"{ui_prim}\",\n        \"tab_bar.background\": \"{bg}\",\n        \"tab.inactive_background\": \"{bg}\",\n        \"tab.active_background\": \"{ui_sec}\",\n        \"toolbar.background\": \"{bg}\",\n        \"status_bar.background\": \"{ui_sec}\",\n        \"panel.background\": \"{bg}\",\n        \"terminal.background\": \"{bg}\",\n        \"terminal.ansi.black\": \"{bg}\",\n        \"terminal.ansi.red\": \"{sem_red}\",\n        \"terminal.ansi.green\": \"{sem_green}\",\n        \"terminal.ansi.yellow\": \"{sem_yellow}\",\n        \"terminal.ansi.blue\": \"{sem_blue}\",\n        \"terminal.ansi.magenta\": \"{syn_acc}\",\n        \"terminal.ansi.cyan\": \"{syn_fun}\",\n        \"terminal.ansi.white\": \"{fg}\",\n        \"terminal.ansi.bright_black\": \"{fg_dim}\",\n        \"terminal.ansi.bright_red\": \"{sem_red}\",\n        \"terminal.ansi.bright_green\": \"{sem_green}\",\n        \"terminal.ansi.bright_yellow\": \"{sem_yellow}\",\n        \"terminal.ansi.bright_blue\": \"{sem_blue}\",\n        \"terminal.ansi.bright_magenta\": \"{syn_acc}\",\n        \"terminal.ansi.bright_cyan\": \"{syn_fun}\",\n        \"terminal.ansi.bright_white\": \"{fg}\",\n        \"conflict\": \"{sem_yellow}\",\n        \"created\": \"{sem_green}\",\n        \"deleted\": \"{sem_red}\",\n        \"error\": \"{sem_red}\",\n        \"hidden\": \"{fg_dim}\",\n        \"hint\": \"{fg_dim}\",\n        \"ignored\": \"{fg_dim}\",\n        \"info\": \"{sem_blue}\",\n        \"modified\": \"{sem_yellow}\",\n        \"predictive\": \"{fg_dim}\",\n        \"renamed\": \"{sem_yellow}\",\n        \"success\": \"{sem_green}\",\n        \"unreachable\": \"{fg_dim}\",\n        \"warning\": \"{sem_yellow}\",\n        \"syntax\": {\n          \"comment\": { \"color\": \"{fg_dim}\", \"font_style\": \"italic\" },\n          \"doc_comment\": { \"color\": \"{fg_dim}\", \"font_style\": \"italic\" },\n          \"keyword\": { \"color\": \"{syn_key}\", \"font_weight\": 700 },\n          \"type\": { \"color\": \"{syn_fun}\", \"font_weight\": 700 },\n          \"function\": { \"color\": \"{syn_fun}\", \"font_weight\": 700 },\n          \"method\": { \"color\": \"{syn_fun}\", \"font_weight\": 700 },\n          \"string\": { \"color\": \"{syn_str}\" },\n          \"string.escape\": { \"color\": \"{syn_acc}\" },\n          \"string.regex\": { \"color\": \"{syn_acc}\" },\n          \"property\": { \"color\": \"{fg}\" },\n          \"variable\": { \"color\": \"{fg}\" },\n          \"variable.special\": { \"color\": \"{syn_acc}\" },\n          \"number\": { \"color\": \"{syn_acc}\" },\n          \"boolean\": { \"color\": \"{syn_acc}\" },\n          \"constant\": { \"color\": \"{syn_acc}\" },\n          \"operator\": { \"color\": \"{fg_dim}\" },\n          \"punctuation\": { \"color\": \"{fg_dim}\" },\n          \"punctuation.bracket\": { \"color\": \"{fg_dim}\" },\n          \"punctuation.delimiter\": { \"color\": \"{fg_dim}\" }\n        }\n      }\n    }\n  ]\n}"}
{"p":"modules/home/thunar.nix","c":"{ ... }:\n{\n  xfconf.enable = true;  # Thunar needs xfconf for settings\n  gtk.enable = true;     # Thunar is GTK app\n  xdg.configFile.\"xfce4/xfconf/xfce-perchannel-xml/thunar.xml\".text = ''\n    <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n    <channel name=\"thunar\" version=\"1.0\">\n      <property name=\"last-view\" type=\"string\" value=\"ThunarDetailsView\"/>\n      <property name=\"last-icon-view-zoom-level\" type=\"string\" value=\"THUNAR_ZOOM_LEVEL_NORMAL\"/>\n      <property name=\"last-details-view-zoom-level\" type=\"string\" value=\"THUNAR_ZOOM_LEVEL_NORMAL\"/>\n      <property name=\"last-window-width\" type=\"int\" value=\"1024\"/>\n      <property name=\"last-window-height\" type=\"int\" value=\"768\"/>\n      <property name=\"misc-single-click\" type=\"bool\" value=\"false\"/>\n      <property name=\"misc-new-tab-as-current\" type=\"bool\" value=\"true\"/>\n    </channel>\n  '';\n  xdg.configFile.\"Thunar/uca.xml\".text = ''\n    <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n    <actions>\n      <action>\n        <icon>utilities-terminal</icon>\n        <name>Open Terminal Here</name>\n        <command>kitty --working-directory=%f</command>\n        <description>Open terminal in this folder</description>\n        <patterns>*</patterns>\n        <directories/>\n      </action>\n    </actions>\n  '';\n}"}
{"p":"modules/home/zed.nix","c":"{ pkgs, ... }:\n{\n  home.packages = [ pkgs.zed-editor ];\n  xdg.configFile.\"zed/settings.json\".text = builtins.toJSON {\n    ui_font_size = 16;\n    buffer_font_size = 16;\n    theme = {\n      mode = \"system\";\n      light = \"Pywal\"; # CHANGED\n      dark = \"Pywal\";  # CHANGED\n    };\n    autosave = \"on_focus_change\";\n    tab_size = 2;\n    soft_wrap = \"editor_width\";\n    terminal = {\n      font_family = \"JetBrains Mono\";\n      font_size = 15;\n    };\n    languages = {\n      Nix = {\n        language_servers = [ \"nixd\" \"nil\" ];\n        formatter = {\n          external = {\n            command = \"nixfmt\";\n            arguments = [ \"--stdin\" ];\n          };\n        };\n      };\n    };\n    lsp = {\n      nixd = {\n        settings = {\n          nixpkgs = {\n            expr = \"import <nixpkgs> { }\";\n          };\n          formatting = {\n            command = [ \"nixfmt\" ];\n          };\n        };\n      };\n    };\n  };\n}"}
{"p":"modules/home/zoxide.nix","c":"_: {\n  programs = {\n    zoxide = {\n      enable = true;\n      enableZshIntegration = true;\n      enableBashIntegration = true;\n      enableFishIntegration = true;\n      options = [\n        \"--cmd cd\"\n      ];\n    };\n  };\n}"}
{"p":"modules/home/zsh.nix","c":"{\n  ...\n}:\nlet\n  variables = import ../../hosts/variables.nix;\n  defaultShell = variables.defaultShell or \"zsh\";\nin\n{\n  programs.zsh = {\n    enable = true;\n    autosuggestion.enable = true;\n    syntaxHighlighting = {\n      enable = true;\n      highlighters = [\n        \"main\"\n        \"brackets\"\n        \"pattern\"\n        \"regexp\"\n        \"root\"\n        \"line\"\n      ];\n    };\n    historySubstringSearch.enable = true;\n    history = {\n      ignoreDups = true;\n      save = 10000;\n      size = 10000;\n    };\n    oh-my-zsh = {\n      enable = true;\n    };\n    plugins = [ ];\n    initContent = ''\n      ${\n        if defaultShell == \"fish\" then\n          ''\n            if [[ $(ps --no-header --pid=$PPID --format=comm) != \"fish\" && -z ''${BASH_EXECUTION_STRING} ]]; then\n              shopt -q login_shell && LOGIN_OPTION='--login' || LOGIN_OPTION=\"\"\n              exec fish $LOGIN_OPTION\n            fi\n          ''\n        else\n          \"\"\n      }\n      bindkey \"\\eh\" backward-word\n      bindkey \"\\ej\" down-line-or-history\n      bindkey \"\\ek\" up-line-or-history\n      bindkey \"\\el\" forward-word\n      if [ -f $HOME/.zshrc-personal ]; then\n        source $HOME/.zshrc-personal\n      fi\n    '';\n    shellAliases = {\n      c = \"clear\";\n      man = \"batman\";\n    };\n  };\n}"}
