{"_meta":{"focus":"Visuals, Theming, Desktop Environment, Rofi, Waybar/AGS","note":"Format: JSONL. RICE/THEME Context Only.","os":"NixOS-Unstable","wm":"Niri"},"rules":{"safety":"NO sed. Use cat <<EOF to OVERWRITE files.","scope":"Only edit files related to visuals/desktop."}}
{"p":"modules/core/stylix.nix","c":"{\n  pkgs,\n  lib,\n  ...\n}: let\n  inherit (import ../../hosts/variables.nix) stylixImage stylixEnable;\nin\nlib.mkIf stylixEnable {\n  stylix = {\n    enable = true;\n    enableReleaseChecks = false;\n    image = stylixImage;\n    polarity = \"dark\";\n    opacity.terminal = 1.0;\n    cursor = {\n      package = pkgs.bibata-cursors;\n      name = \"Bibata-Modern-Ice\";\n      size = 24;\n    };\n    fonts = {\n      monospace = {\n        package = pkgs.nerd-fonts.jetbrains-mono;\n        name = \"JetBrains Mono\";\n      };\n      sansSerif = {\n        package = pkgs.montserrat;\n        name = \"Montserrat\";\n      };\n      serif = {\n        package = pkgs.montserrat;\n        name = \"Montserrat\";\n      };\n      sizes = {\n        applications = 12;\n        terminal = 15;\n        desktop = 11;\n        popups = 12;\n      };\n    };\n  };\n}"}
{"p":"modules/home/desktop/default.nix","c":"{ ... }:\n{\n  imports = [\n    ./niri\n    ./rofi\n  ];\n}"}
{"p":"modules/home/desktop/niri/default.nix","c":"{ ... }:\n{\n  imports = [\n    ./niri.nix\n  ];\n}"}
{"p":"modules/home/desktop/niri/keybinds.nix","c":"{\n  terminal,\n  browser,\n  hostKeybinds ? \"\",\n  ...\n}:\n''\n  binds {\n      // === Apps ===\n      Mod+Return { spawn \"${terminal}\"; }\n      Mod+B { spawn \"${browser}\"; }\n      Mod+E { spawn \"errands\"; }\n      Mod+Z { spawn \"zeditor\"; }\n      Mod+Space { spawn \"launcher\"; }\n      Ctrl+Q { spawn \"launcher\" \"windows\"; }\n      Mod+Shift+W { spawn \"wall-select\"; }\n      // === Deezer ===\n      XF86AudioRaiseVolume allow-when-locked=true { spawn \"playerctl\" \"--player=Deezer\" \"volume\" \"0.05+\"; }\n      XF86AudioLowerVolume allow-when-locked=true { spawn \"playerctl\" \"--player=Deezer\" \"volume\" \"0.05-\"; }\n      XF86AudioMute        allow-when-locked=true { spawn \"playerctl\" \"--player=Deezer\" \"play-pause\"; }\n      XF86AudioPlay        allow-when-locked=true { spawn \"playerctl\" \"--player=Deezer\" \"play-pause\"; }\n      XF86AudioNext        allow-when-locked=true { spawn \"playerctl\" \"--player=Deezer\" \"next\"; }\n      XF86AudioPrev        allow-when-locked=true { spawn \"playerctl\" \"--player=Deezer\" \"previous\"; }\n      Mod+WheelScrollDown cooldown-ms=50 { spawn \"playerctl\" \"--player=Deezer\" \"volume\" \"0.05-\"; }\n      Mod+WheelScrollUp   cooldown-ms=50 { spawn \"playerctl\" \"--player=Deezer\" \"volume\" \"0.05+\"; }\n      Mod+MouseMiddle     { spawn \"playerctl\" \"--player=Deezer\" \"play-pause\"; }\n      // === Desktop Brightness (Native) ===\n      // Works because Udev attached the driver automatically!\n      Mod+F1 { spawn \"swayosd-client\" \"--brightness\" \"lower\"; }\n      Mod+F2 { spawn \"swayosd-client\" \"--brightness\" \"raise\"; }\n      // === System & Window Management ===\n      Mod+S { screenshot; }\n      Mod+Q { close-window; }\n      Mod+Shift+Q { quit; }\n      Mod+L { spawn \"loginctl\" \"lock-session\"; }\n      Mod+Minus { set-column-width \"33.333%\"; }\n      Mod+Equal { set-column-width \"50%\"; }\n      Mod+BracketLeft { set-column-width \"66.667%\"; }\n      Mod+BracketRight { set-column-width \"100%\"; }\n      Mod+R { switch-preset-column-width; }\n      Mod+F { maximize-column; }\n      Mod+Shift+F { fullscreen-window; }\n      Mod+C { center-column; }\n      Mod+Left  { focus-column-left; }\n      Mod+Right { focus-column-right; }\n      Mod+Shift+Left  { move-column-left; }\n      Mod+Shift+Right { move-column-right; }\n      Mod+Down  { focus-workspace-down; }\n      Mod+Up    { focus-workspace-up; }\n      Mod+Shift+Down  { move-column-to-workspace-down; }\n      Mod+Shift+Up    { move-column-to-workspace-up; }\n      Mod+J     { focus-window-down; }\n      Mod+K     { focus-window-up; }\n      ${hostKeybinds}\n  }\n''"}
{"p":"modules/home/desktop/niri/layout.nix","c":"{ ... }:\n''\n  config-notification {\n      disable-failed\n  }\n  gestures {\n      hot-corners {\n          off\n      }\n  }\n  input {\n      keyboard {\n          xkb {\n          }\n          numlock\n      }\n      touchpad {\n          // Natural scrolling inverts scroll direction\n          // Up swipe scrolls down, down swipe scrolls up (natural direction)\n          natural-scroll\n      }\n      mouse {\n          accel-profile \"adaptive\"\n          accel-speed 1.0\n      }\n      trackpoint {\n      }\n      focus-follows-mouse\n      warp-mouse-to-focus\n  }\n  layout {\n      gaps 9\n      center-focused-column \"never\"\n      always-center-single-column\n      preset-column-widths {\n          proportion 0.33333\n          proportion 0.5\n          proportion 0.66667\n          proportion 1.0\n      }\n      default-column-width { proportion 0.5; }\n      border {\n          width 2\n          active-color \"#cba6f7\"\n          inactive-color \"#45475a\"\n          urgent-color \"#f5c2e7\"\n      }\n      focus-ring {\n          off\n          width 2\n          active-color   \"#808080\"\n          inactive-color \"#505050\"\n      }\n      shadow {\n          softness 30\n          spread 5\n          offset x=0 y=5\n          color \"#0007\"\n      }\n      struts {\n      }\n  }\n  /-layer-rule {\n      match namespace=\"^quickshell$\"\n      place-within-backdrop true\n  }\n  overview {\n      backdrop-color \"#1e1e2e\"\n      workspace-shadow {\n          softness 40\n          spread 10\n          offset x=0 y=10\n          color \"#00000050\"\n      }\n      zoom 0.5\n  }\n  animations {\n      workspace-switch {\n          spring damping-ratio=0.80 stiffness=523 epsilon=0.0001\n      }\n      window-open {\n          duration-ms 150\n          curve \"ease-out-expo\"\n      }\n      window-close {\n          duration-ms 150\n          curve \"ease-out-quad\"\n      }\n      horizontal-view-movement {\n          spring damping-ratio=0.85 stiffness=423 epsilon=0.0001\n      }\n      window-movement {\n          spring damping-ratio=0.75 stiffness=323 epsilon=0.0001\n      }\n      window-resize {\n          spring damping-ratio=0.85 stiffness=423 epsilon=0.0001\n      }\n      config-notification-open-close {\n          spring damping-ratio=0.65 stiffness=923 epsilon=0.001\n      }\n      screenshot-ui-open {\n          duration-ms 200\n          curve \"ease-out-quad\"\n      }\n      overview-open-close {\n          spring damping-ratio=0.85 stiffness=800 epsilon=0.0001\n      }\n  }\n''"}
{"p":"modules/home/desktop/niri/niri.nix","c":"{\n  host,\n  config,\n  pkgs,\n  lib,\n  ...\n}:\nlet\n  variables = import ../../../../hosts/variables.nix;\n  inherit (variables)\n    browser\n    terminal\n    stylixImage\n    startupApps\n    monitorConfig\n    ;\n  barChoice = variables.barChoice or \"waybar\";\n  hostKeybindsPath = ./hosts/${host}/keybinds.nix;\n  hostKeybinds =\n    if builtins.pathExists hostKeybindsPath then import hostKeybindsPath { inherit host; } else \"\";\n  keybindsModule = import ./keybinds.nix {\n    inherit host terminal browser barChoice hostKeybinds config;\n  };\n  windowrulesModule = import ./windowrules.nix { inherit host; };\n  layoutModule = import ./layout.nix { inherit config; };\n  workspacesModule = import ./workspaces.nix { };\n  startupModule = import ./startup.nix {\n    inherit host stylixImage startupApps barChoice pkgs;\n  };\n  hostOutputsPath = ./hosts/${host}/outputs.nix;\n  hostOutputs =\n    if builtins.pathExists hostOutputsPath then\n      import hostOutputsPath { inherit host; }\n    else\n      monitorConfig;\n  hostWindowRulesPath = ./hosts/${host}/windowrules.nix;\n  hostWindowRules =\n    if builtins.pathExists hostWindowRulesPath then\n      import hostWindowRulesPath { inherit host; }\n    else\n      \"\";\n  baseConfig = ''\n    // Niri Configuration for ${host}\n    // Generated by NixOS configuration - BASE PART\n    ${hostOutputs}\n    ${workspacesModule}\n    ${layoutModule}\n    ${keybindsModule}\n    ${windowrulesModule}\n    ${hostWindowRules}\n    ${startupModule}\n    environment {\n          XDG_CURRENT_DESKTOP \"niri\"\n          GTK_USE_PORTAL \"1\"\n          MOZ_ENABLE_WAYLAND \"1\"\n          NIXOS_OZONE_WL \"1\"\n          ELECTRON_OZONE_PLATFORM_HINT \"wayland\"\n          QT_QPA_PLATFORM \"wayland\"\n          QT_QPA_PLATFORMTHEME \"gtk3\"\n          QT_QPA_PLATFORMTHEME_QT6 \"gtk3\"\n          TERMINAL \"${terminal}\"\n          XCURSOR_THEME \"Bibata-Modern-Ice\"\n          XCURSOR_SIZE \"24\"\n          __GL_GSYNC_ALLOWED \"1\"\n          __GL_VRR_ALLOWED \"1\"\n          PROTON_ENABLE_NVAPI \"1\"\n          PROTON_HIDE_NVIDIA_GPU \"0\"\n          PROTON_ENABLE_NGX_UPDATER \"1\"\n    }\n    hotkey-overlay {\n        skip-at-startup\n    }\n    prefer-no-csd\n    screenshot-path \"~/Pictures/Screenshots/Screenshot from %Y-%m-%d %H-%M-%S.png\"\n  '';\nin\n{\n  home.packages = with pkgs; [\n    niri\n    udiskie\n    xwayland-satellite\n    swww\n    grim\n    slurp\n    wl-clipboard\n    swappy\n  ];\n  xdg.configFile.\"niri/config-base.kdl\".text = baseConfig;\n  systemd.user.services.niri-config-assembler = {\n    Unit = {\n      Description = \"Assemble Niri Config (Base + Colors)\";\n      Before = [ \"graphical-session.target\" ];\n    };\n    Service = {\n      Type = \"oneshot\";\n      ExecStart = pkgs.writeShellScript \"assemble-niri-config\" ''\n        BASE=\"$HOME/.config/niri/config-base.kdl\"\n        COLORS=\"$HOME/.config/niri/colors.kdl\"\n        FINAL=\"$HOME/.config/niri/config.kdl\"\n        if [ ! -f \"$COLORS\" ]; then\n          mkdir -p \"$(dirname \"$COLORS\")\"\n          echo \"// Fallback Colors\" > \"$COLORS\"\n          echo \"window-rule { border { active-color \\\"#ff0000\\\"; } }\" >> \"$COLORS\"\n        fi\n        cat \"$BASE\" \"$COLORS\" > \"$FINAL\"\n      '';\n    };\n    Install.WantedBy = [ \"graphical-session.target\" ];\n  };\n  home.activation.setupNiriConfig = lib.hm.dag.entryAfter [ \"writeBoundary\" ] ''\n    $DRY_RUN_CMD ${pkgs.systemd}/bin/systemctl --user start niri-config-assembler.service\n  '';\n  systemd.user.targets.niri-session = {\n    Unit = {\n      Description = \"Niri compositor session\";\n      BindsTo = \"graphical-session.target\";\n      Wants = \"graphical-session-pre.target\";\n      After = \"graphical-session-pre.target\";\n    };\n  };\n  systemd.user.services.waybar-niri = lib.mkIf (barChoice == \"waybar\") {\n    Unit = {\n      Description = \"Waybar status bar\";\n      PartOf = \"graphical-session.target\";\n      ConditionEnvironment = \"XDG_CURRENT_DESKTOP=niri\";\n    };\n    Service = {\n      ExecStart = \"${pkgs.waybar}/bin/waybar\";\n      Restart = \"on-failure\";\n    };\n    Install.WantedBy = [ \"graphical-session.target\" ];\n  };\n  systemd.user.services.xwayland-satellite = {\n    Unit = {\n      Description = \"Xwayland outside Wayland\";\n      BindsTo = \"graphical-session.target\";\n      After = \"graphical-session.target\";\n    };\n    Service = {\n      Type = \"notify\";\n      NotifyAccess = \"all\";\n      ExecStart = \"${pkgs.xwayland-satellite}/bin/xwayland-satellite\";\n      StandardOutput = \"journal\";\n      Restart = \"on-failure\";\n    };\n    Install.WantedBy = [ \"graphical-session.target\" ];\n  };\n  home.file = {\n    \"Pictures/Wallpapers\" = {\n      source = ../../../../wallpapers;\n      recursive = true;\n    };\n  };\n}"}
{"p":"modules/home/desktop/niri/startup.nix","c":"{\n  pkgs,\n  stylixImage,\n  barChoice,\n  ...\n}:\nlet\n  barStartupCommand =\n    if barChoice == \"noctalia\" then\n      ''spawn-at-startup \"noctalia-shell\"''\n    else\n      ''// ${barChoice} started via systemd service'';\n  polkitAgent = \"${pkgs.mate.mate-polkit}/libexec/polkit-mate-authentication-agent-1\";\n  updateEnv = pkgs.writeShellScript \"niri-env-update\" ''\n    export XDG_CURRENT_DESKTOP=niri\n    export XDG_SESSION_DESKTOP=niri\n    export XDG_SESSION_TYPE=wayland\n    ${pkgs.dbus}/bin/dbus-update-activation-environment --systemd \\\n      XDG_CURRENT_DESKTOP \\\n      XDG_SESSION_DESKTOP \\\n      XDG_SESSION_TYPE \\\n      WAYLAND_DISPLAY\n    ${pkgs.systemd}/bin/systemctl --user import-environment \\\n      XDG_CURRENT_DESKTOP \\\n      XDG_SESSION_DESKTOP \\\n      XDG_SESSION_TYPE \\\n      WAYLAND_DISPLAY\n  '';\nin\n''\n  // 1. Run the Environment Fix script immediately\n  spawn-at-startup \"${updateEnv}\"\n  // 2. Start Polkit (Password prompts)\n  spawn-at-startup \"${polkitAgent}\"\n  // 3. Start SwayOSD Server (The background worker)\n  spawn-at-startup \"swayosd-server\"\n  // 4. Desktop Components\n  spawn-at-startup \"bash\" \"-c\" \"wl-paste --watch cliphist store &\"\n  spawn-at-startup \"bash\" \"-c\" \"swww-daemon && sleep 1 && swww img '${stylixImage}'\"\n  ${barStartupCommand}\n  spawn-at-startup \"wal\" \"-R\"\n  // 5. Apps (Apps will trigger the portal restart automatically now)\n  spawn-at-startup \"vivaldi\"\n  spawn-at-startup \"corectrl\"\n  spawn-at-startup \"bash\" \"-c\" \"deezer-enhanced --ozone-platform=wayland & sleep 2; vesktop &\"\n''"}
{"p":"modules/home/desktop/niri/windowrules.nix","c":"{ ... }:\n''\n  // --- Global Look ---\n  window-rule {\n      geometry-corner-radius 12\n      clip-to-geometry true\n      draw-border-with-background false\n  }\n  // --- Rofi Specific Rule (Shadows & Floating) ---\n  window-rule {\n      match app-id=\"^rofi$\"\n      open-floating true\n      shadow {\n          on\n          softness 30\n          spread 10\n          color \"#00000080\"\n      }\n  }\n  // --- ERRANDS (Floating & Centered) ---\n  window-rule {\n      match app-id=r#\"^errands$|^io\\.github\\\\.mrvladus\\\\.List$\"#\n      open-floating true\n      default-column-width { proportion 0.4; }\n      default-window-height { proportion 0.6; }\n  }\n  // --- Workspace 1 Rules (Browser) ---\n  window-rule {\n      match at-startup=true app-id=r#\"^vivaldi.*$\"#\n      open-on-workspace \"1\"\n      default-column-width { proportion 0.66667; }\n  }\n  // --- ZED EDITOR ---\n  window-rule {\n      match app-id=r#\"^dev\\\\.zed\\\\.Zed$\"#\n      default-column-width { proportion 0.33333; }\n  }\n  // --- Workspace 2 Rules (Music/Chat) ---\n  window-rule {\n      match at-startup=true app-id=\"deezer-enhanced\"\n      open-on-workspace \"2\"\n      default-column-width { proportion 0.33333; }\n  }\n  window-rule {\n      match at-startup=true app-id=\"vesktop\"\n      open-on-workspace \"2\"\n      default-column-width { proportion 0.66667; }\n  }\n''"}
{"p":"modules/home/desktop/niri/workspaces.nix","c":"{ ... }:\n''\n  // Declare named workspaces so they exist at startup\n  // This allows open-on-workspace rules to work reliably\n  workspace \"1\" {\n      // You can pin this to a monitor if you have multiple\n      // open-on-output \"DP-1\"\n  }\n  workspace \"2\" {\n      // open-on-output \"DP-1\"\n  }\n''"}
{"p":"modules/home/desktop/rofi/config/WallSelect.rasi","c":"/* ===========================================================================\n   WallSelect.rasi - Visual Wallpaper Selector Theme\n   ===========================================================================\n   Purpose: Creates a horizontal scrolling \"card\" layout for wallpaper previews.\n   Color scheme is imported from Matugen-generated colors.rasi.\n   =========================================================================== */\n/* Import color variables (background, foreground, selected, etc.) */\n@import \"colors.rasi\"\n/* ===========================================================================\n   CONFIGURATION VARIABLES\n   Adjust these values to fine-tune the layout without hunting through the code.\n   =========================================================================== */\n* {\n    /* -- Dimensions --\n       These MUST match the thumbnail generation geometry in scripts.nix.\n       Script uses: WIDTH=415, HEIGHT=550 (3:4 portrait aspect ratio).\n       If you change the script, update these values and recalculate window width. */\n    var-preview-height:          550px;  /* Height of the thumbnail image */\n    var-preview-width:           415px;  /* Width of the thumbnail image */\n    /* -- Spacing --\n       Controls gaps between cards and between cards and window edges.\n       Use the SAME value for consistent inner/outer spacing. */\n    var-gap-size:                25px;   /* Space around and between cards */\n    /* -- Card Padding --\n       Controls the \"fatness\" of the selector. Smaller = tighter fit.\n       This is the space between the image/text and the card's colored border. */\n    var-item-padding:            10px;   /* REDUCED from 15px for slimmer cards */\n    /* -- Window Height --\n       Calculation: preview height + space for text + card padding + window padding.\n       Increase if text is clipped; decrease for tighter fit. */\n    var-window-height:           650px;  /* Total height of the Rofi window */\n}\n/* ===========================================================================\n   WINDOW STYLE\n   The outer container for the entire selector.\n   =========================================================================== */\nwindow {\n    /* Make window see-through (requires compositor like Picom/Hyprland) */\n    transparency:                \"real\";\n    /* Center window on screen */\n    location:                    center;\n    anchor:                      center;\n    /* -- FIXED WIDTH CALCULATION --\n       We MUST use a hardcoded pixel value because Rofi's calc() doesn't support variables.\n       Formula: (var-preview-width * number of columns) + (var-gap-size * (columns + 1))\n       Example: (415px * 5) + (25px * 6) = 2075 + 150 = 2225px\n       This ensures exactly 5 cards with equal gaps on all sides. */\n    width:                       2225px;  /* CALCULATED: DO NOT EDIT DIRECTLY */\n    height:                      @var-window-height;\n    /* Window border and background */\n    enabled:                     true;\n    margin:                      0px;\n    padding:                     0px;\n    border:                      0px solid;\n    border-radius:               16px;    /* Rounded corners for the overall window */\n    background-color:            @background;\n    cursor:                      \"default\";\n}\n/* ===========================================================================\n   MAINBOX (CONTENT CONTAINER)\n   Holds the listview and applies the outermost padding inside the window.\n   =========================================================================== */\nmainbox {\n    enabled:                     true;\n    margin:                      0px;\n    background-color:            transparent; /* Let window background show through */\n    children:                    [ \"listview\" ];\n    /* Apply uniform padding around the entire grid of cards.\n       This creates equal \"dead space\" at window edges: top, right, bottom, left. */\n    padding:                     @var-gap-size;\n}\n/* ===========================================================================\n   LISTVIEW (GRID CONTAINER)\n   Configures the horizontal flow and layout of the cards.\n   =========================================================================== */\nlistview {\n    enabled:                     true;\n    columns:                     5;       /* Show exactly 5 items per row */\n    lines:                       1;       /* Single row for horizontal scrolling */\n    /* Behavior: enable cycling, dynamic loading, no scrollbar */\n    cycle:                       true;\n    dynamic:                     true;\n    scrollbar:                   false;\n    /* Layout: horizontal flow (left-to-right) */\n    layout:                      vertical;\n    flow:                        horizontal;\n    reverse:                     false;\n    fixed-height:                true;\n    fixed-columns:               true;\n    /* Space between individual cards (horizontal gap) */\n    spacing:                     @var-gap-size;\n    background-color:            transparent;\n    text-color:                  @foreground;\n    cursor:                      \"default\";\n}\n/* ===========================================================================\n   ELEMENT (INDIVIDUAL CARD)\n   The \"card\" that holds each wallpaper preview and its filename.\n   This is the \"purple selector\" when in selected state.\n   =========================================================================== */\nelement {\n    enabled:                     true;\n    orientation:                 vertical; /* Stack image above text */\n    /* -- FIXED WIDTH --\n       Forces each card to be exactly as wide as the preview image.\n       This prevents resizing and ensures perfect alignment. */\n    width:                       @var-preview-width;\n    /* -- INTERNAL PADDING (Fatness) --\n       Space between card border and its content (image/text).\n       REDUCED to 10px to make the pink selector less \"fat\". */\n    padding:                     @var-item-padding;\n    /* -- ROUNDED CORNERS FOR CARD --\n       This rounds the selector's background (the pink highlight).\n       To also round the IMAGE inside, see element-icon below. */\n    border-radius:               12px;    /* Rounded corners for the card */\n    /* Colors and interaction */\n    background-color:            transparent; /* Default: no background */\n    text-color:                  @foreground;\n    cursor:                      pointer;\n}\n/* -- Element States --\n   Define styles for normal, alternate (unused here), and selected cards.\n   The \"pink\" selector is element selected.normal. */\n/* Unselected cards (default state) */\nelement normal.normal {\n    background-color:            transparent; /* Invisible background */\n    text-color:                  @foreground;\n}\n/* Alternate rows (optional, kept transparent for consistent look) */\nelement alternate.normal {\n    background-color:            transparent;\n    text-color:                  @foreground;\n}\n/* SELECTED CARD (the \"purple/pink selector\") */\nelement selected.normal {\n    background-color:            @selected;   /* Pink/purple highlight color */\n    text-color:                  @text-selected; /* Text color on highlight */\n}\n/* ===========================================================================\n   ELEMENT-ICON (WALLPAPER THUMBNAIL)\n   The actual image preview. We want this to have rounded corners too.\n   =========================================================================== */\nelement-icon {\n    /* Set image size to match our thumbnail generation */\n    size:                        @var-preview-height;\n    /* -- ROUNDED IMAGE CORNERS --\n       WARNING: This may not clip the image in all Rofi versions.\n       It draws rounded corners on the icon widget's background, but the image\n       might bleed over. In practice, with transparent backgrounds, it often\n       creates the *visual effect* of rounded corners. If you see square corners,\n       this is a Rofi limitation. Generating rounded thumbnails is an alternative. */\n    border-radius:               8px;       /* Smaller radius than the card */\n    cursor:                      inherit;   /* Use parent's pointer cursor */\n    background-color:            transparent;\n    text-color:                  inherit;   /* Inherit text color (unused here) */\n    horizontal-align:            0.5;       /* Center horizontally */\n}\n/* ===========================================================================\n   ELEMENT-TEXT (WALLPAPER FILENAME)\n   The text label under each preview.\n   =========================================================================== */\nelement-text {\n    /* -- BALANCED INTERNAL SPACING --\n       We want equal visual space ABOVE the image and BELOW the text.\n       The card's top/bottom padding handles most of this.\n       This 5px top margin adds a small gap between image and text.\n       It was reduced from 10px to balance the \"dead space\" better. */\n    margin:                      5px 0px 0px 0px; /* Top: 5px, Others: 0px */\n    /* Align text horizontally and vertically */\n    vertical-align:              0.5;       /* Center vertically in its box */\n    horizontal-align:            0.5;       /* Center horizontally */\n    /* Inherit styles from parent */\n    cursor:                      inherit;\n    background-color:            transparent;\n    text-color:                  inherit;\n}"}
{"p":"modules/home/desktop/rofi/config/launcher.rasi","c":"/* ===========================================================================\n   Rofi Theme - Compact & Most Used\n   =========================================================================== */\n@import \"colors.rasi\"\n/* --- Configuration --- */\nconfiguration {\n    show-icons:                 true;\n    drun-display-format:        \"{name}\";\n    /* SORTING: Enable history so used apps float to top */\n    disable-history:            false;\n    sort:                       true;\n    sorting-method:             \"fzf\";\n    matching:                   \"fuzzy\";\n    /* Bindings */\n    kb-mode-next:               \"Control+Tab\";\n    kb-mode-prev:               \"Control+Shift+Tab\";\n}\n/* --- Global Properties --- */\n* {\n    background-color:            transparent;\n    text-color:                  @foreground;\n    margin:                      0px;\n    padding:                     0px;\n    spacing:                     0px;\n}\n/* --- Window --- */\nwindow {\n    /* Compact Sizing (Matches wall-select height) */\n    width:                       1000px;\n    height:                      650px;\n    location:                    center;\n    anchor:                      center;\n    background-color:            @background;\n    border-radius:               16px;\n    /* Safe Border */\n    border:                      2px;\n    border-color:                @selected;\n    cursor:                      \"default\";\n}\nmainbox {\n    orientation:                 horizontal;\n    children:                    [ \"left-area\", \"right-area\" ];\n    background-color:            transparent;\n}\n/* ===========================================================================\n   LEFT AREA (Wallpaper + Button Bar)\n   =========================================================================== */\nleft-area {\n    /* Smaller sidebar width */\n    width:                       380px;\n    expand:                      false;\n    /* Wallpaper */\n    background-image:            url(\"~/.cache/rofi-launcher.jpg\", height);\n    /* Layout: Push mode-switcher to bottom */\n    orientation:                 vertical;\n    children:                    [ \"dummy\", \"mode-switcher\" ];\n    padding:                     20px;\n}\ndummy {\n    expand:                      true;\n    background-color:            transparent;\n}\n/* The Button Bar */\nmode-switcher {\n    orientation:                 horizontal;\n    enabled:                     true;\n    spacing:                     8px;           /* Reduced from 20px */\n    background-color:            @background;\n    text-color:                  @foreground;\n    opacity:                     0.9;\n    padding:                     4px;           /* Reduced from 10px */\n    border-radius:               8px;           /* Reduced from 12px */\n}\nbutton {\n    padding:                     6px 12px;      /* Smaller padding */\n    border-radius:               6px;           /* Reduced from 8px */\n    background-color:            transparent;\n    text-color:                  @foreground-muted;\n    cursor:                      pointer;\n    font:                        \"Sans 9\";      /* Smaller font */\n}\nbutton selected {\n    background-color:            @selected;\n    text-color:                  @text-selected;\n}\n/* ===========================================================================\n   RIGHT AREA (App Grid)\n   =========================================================================== */\nright-area {\n    expand:                      true;\n    orientation:                 vertical;\n    children:                    [ \"inputbar\", \"listview\" ];\n    padding:                     30px;\n    spacing:                     20px;\n    background-color:            @background;\n}\ninputbar {\n    padding:                     12px;\n    border-radius:               12px;\n    background-color:            @background-alt;\n    text-color:                  @foreground;\n    children:                    [ \"entry\" ];\n}\nentry {\n    placeholder:                 \"Search apps...\";\n    placeholder-color:           @foreground-muted;\n    text-color:                  @foreground;\n    cursor:                      text;\n    vertical-align:              0.5;\n}\nlistview {\n    /* COMPACT GRID */\n    columns:                     4;\n    lines:                       3;\n    cycle:                       true;\n    dynamic:                     true;\n    scrollbar:                   false;\n    spacing:                     15px;\n}\n/* ===========================================================================\n   GRID ELEMENTS\n   =========================================================================== */\nelement {\n    /* Vertical: Icon Top, Text Bottom */\n    orientation:                 vertical;\n    padding:                     15px;\n    border-radius:               16px;\n    cursor:                      pointer;\n    spacing:                     8px;\n}\nelement selected {\n    background-color:            @selected;\n    text-color:                  @text-selected;\n}\nelement-icon {\n    /* Slightly smaller icons for compact look */\n    size:                        58px;\n    horizontal-align:            0.5;\n    background-color:            transparent;\n    cursor:                      inherit;\n}\nelement-icon {\n    size:                        48px;  /* MAKE THIS LARGER IF ICONS ARE HIDDEN */\n    horizontal-align:            0.5;\n    background-color:            transparent;\n}\nelement-text {\n    markup:                      true;\n    horizontal-align:            0.5;\n    vertical-align:              0.5;\n    background-color:            transparent;\n    text-color:                  inherit;\n    font:                        \"Sans 10\";\n}"}
{"p":"modules/home/desktop/rofi/default.nix","c":"{ ... }:\n{\n  imports = [\n    ./rofi.nix\n    ./launcher.nix\n    ./niri-kill.nix\n  ];\n}"}
{"p":"modules/home/desktop/rofi/launcher.nix","c":"{ pkgs, config, lib, ... }:\nlet\n  rofiBg = \"${config.home.homeDirectory}/.cache/rofi-launcher.jpg\";\nin\n{\n  home.packages = [\n    (pkgs.writeShellScriptBin \"launcher\" ''\n      set -e\n      if [ ! -f \"${rofiBg}\" ]; then\n        ${pkgs.imagemagick}/bin/convert \"${config.stylix.image}\" -resize ^400x650 -gravity center -extent 400x650 \"${rofiBg}\"\n      fi\n      MODE=\"${\"\\$1\"}\"\n      if [ -z \"$MODE\" ]; then MODE=\"drun\"; fi\n      ${pkgs.rofi}/bin/rofi \\\n        -show \"$MODE\" \\\n        -theme \"${config.home.homeDirectory}/.config/rofi/launcher.rasi\" \\\n        -modes \"drun,windows:rofi-niri-kill,filebrowser\" \\\n        -display-drun \"Apps\" \\\n        -display-windows \"Kill\" \\\n        -display-filebrowser \"Files\" \\\n        -markup-rows \\\n        -kb-mode-next \"Control+Tab\" \\\n        -kb-mode-prev \"Control+Shift+Tab\"\n    '')\n  ];\n  xdg.configFile.\"rofi/launcher.rasi\".source = ./config/launcher.rasi;\n  home.activation.setupWallpaperCache = lib.hm.dag.entryAfter [ \"writeBoundary\" ] ''\n    if [ ! -f \"${rofiBg}\" ]; then\n      echo \"Initializing Rofi Sidebar...\"\n      ${pkgs.imagemagick}/bin/convert \"${config.stylix.image}\" -resize ^400x650 -gravity center -extent 400x650 \"${rofiBg}\"\n    fi\n  '';\n}"}
{"p":"modules/home/desktop/rofi/niri-kill.nix","c":"{ pkgs, ... }:\n{\n  home.packages = [\n    (pkgs.writeScriptBin \"rofi-niri-kill\" ''\n      export LC_ALL=C.UTF-8\n      if [ -n \"''${ROFI_INFO:-}\" ]; then\n        ${pkgs.niri}/bin/niri msg action close-window --id \"$ROFI_INFO\"\n        exit 0\n      fi\n      ${pkgs.niri}/bin/niri msg -j windows 2>/dev/null | \\\n      ${pkgs.jq}/bin/jq -r '.[] | select(.app_id != null) | \"\\(.id)\\t\\(.app_id)\"' | \\\n      while IFS=$'\\t' read -r id app; do\n        [ -z \"$id\" ] && continue\n        case \"$app\" in\n          xwayland-satellite|swappy|grim|slurp|wl-clipboard|cliphist|swayosd*|udiskie|swww*|polkit*|waybar) continue ;;\n        esac\n        name=\"$app\"\n        icon=\"application-x-executable\"\n        case \"$app\" in\n          \"dev.zed.Zed\") name=\"Zed\"; icon=\"zed\" ;;\n          \"kitty\")       name=\"Kitty\"; icon=\"kitty\" ;;\n          \"vesktop\")     name=\"Discord\"; icon=\"discord\" ;;\n          \"vivaldi-stable\") name=\"Vivaldi\"; icon=\"vivaldi\" ;;\n          \"deezer-enhanced\") name=\"Deezer\"; icon=\"deezer\" ;;\n        esac\n        printf \"%s\\0icon\\037%s\\037info\\037%s\\n\" \"$name\" \"$icon\" \"$id\"\n      done || true\n    '')\n    pkgs.jq\n  ];\n}"}
{"p":"modules/home/desktop/rofi/rofi.nix","c":"{ pkgs, ... }:\n{\n  home.packages = [ pkgs.rofi ];\n  xdg.configFile.\"rofi/config.rasi\".source = ./config/launcher.rasi;\n}"}
{"p":"modules/home/gtk.nix","c":"{ pkgs, ... }:\n{\n  gtk = {\n    enable = true;\n    iconTheme = {\n      name = \"Tela-purple-dark\";\n      package = pkgs.tela-icon-theme;\n    };\n    gtk3.extraConfig = {\n      gtk-application-prefer-dark-theme = 1;\n    };\n    gtk4.extraConfig = {\n      gtk-application-prefer-dark-theme = 1;\n    };\n  };\n}"}
{"p":"modules/home/kitty.nix","c":"{ pkgs, host, ... }:\nlet\n  variables = import ../../hosts/variables.nix;\n  defaultShell = variables.defaultShell or \"zsh\";\n  shellPackage = if defaultShell == \"fish\" then pkgs.fish else pkgs.zsh;\nin\n{\n  programs.kitty = {\n    enable = true;\n    package = pkgs.kitty;\n    settings = {\n      shell = \"${shellPackage}/bin/${defaultShell}\";\n      font_size = 12;\n      font_family = \"JetBrains Mono\";\n      window_padding_width = 4;\n      confirm_os_window_close = 0;\n      enable_audio_bell = false;\n      cursor_trail = 1;\n      allow_remote_control = \"yes\";\n      listen_on = \"unix:@mykitty\";\n      include = \"~/.cache/wal/colors-kitty.conf\";\n    };\n    extraConfig = ''\n      map ctrl+shift+t new_tab\n      map ctrl+shift+q close_tab\n      map alt+n new_os_window\n      map alt+w close_window\n    '';\n  };\n}"}
{"p":"modules/home/qt.nix","c":"_: {\n  qt = {\n    enable = true;\n  };\n}"}
{"p":"modules/home/starship.nix","c":"{\n  lib,\n  ...\n}:\nlet\n  variables = import ../../hosts/variables.nix;\n  defaultShell = variables.defaultShell or \"zsh\";\nin\n{\n  programs.starship = {\n    enable = defaultShell != \"fish\";\n    settings = {\n      add_newline = false;\n      format = lib.concatStrings [\n        \"$nix_shell\"\n        \"$hostname\"\n        \"$directory\"\n        \"$git_branch\"\n        \"$git_state\"\n        \"$git_status\"\n        \"\\n\"\n        \"$character\"\n      ];\n      directory = {\n        style = \"bold blue\";\n      };\n      character = {\n        success_symbol = \"[‚ùØ](bold green)\";\n        error_symbol = \"[‚ùØ](bold red)\";\n        vimcmd_symbol = \"[‚ùÆ](cyan)\";\n      };\n      nix_shell = {\n        format = \"[$symbol]($style) \";\n        symbol = \"üêö\";\n        style = \"\";\n      };\n      git_branch = {\n        symbol = \"Ôêò \";\n        style = \"bold purple\";\n        format = \"on [$symbol$branch]($style) \";\n      };\n      git_status = {\n        format = \"[[(*$conflicted$untracked$modified$staged$renamed$deleted)](218)($ahead_behind$stashed)]($style)\";\n        style = \"cyan\";\n        conflicted = \"\";\n        renamed = \"\";\n        deleted = \"\";\n        stashed = \"‚â°\";\n      };\n      git_state = {\n        format = \"([$state( $progress_current/$progress_total)]($style)) \";\n        style = \"bright-black\";\n      };\n    };\n  };\n}"}
{"p":"modules/home/stylix.nix","c":"{\n  pkgs,\n  lib,\n  ...\n}:\nlet\n  variables = import ../../hosts/variables.nix;\n  inherit (variables) stylixImage stylixEnable;\nin\nlib.mkIf stylixEnable {\n  stylix = {\n    enable = true;\n    image = stylixImage;\n    autoEnable = false;\n    targets.gtk.enable = false;\n    targets.kitty.enable = false;\n    polarity = \"dark\";\n    cursor = {\n      package = pkgs.bibata-cursors;\n      name = \"Bibata-Modern-Ice\";\n      size = 24;\n    };\n    fonts = {\n      monospace = {\n        package = pkgs.nerd-fonts.jetbrains-mono;\n        name = \"JetBrains Mono\";\n      };\n      sansSerif = {\n        package = pkgs.montserrat;\n        name = \"Montserrat\";\n      };\n      serif = {\n        package = pkgs.montserrat;\n        name = \"Montserrat\";\n      };\n      sizes = {\n        applications = 12;\n        terminal = 15;\n        desktop = 11;\n        popups = 12;\n      };\n    };\n  };\n}"}
{"p":"modules/home/theme/default.nix","c":"{ pkgs, ... }:\n{\n  imports = [\n    ./scripts.nix\n  ];\n  home.packages = with pkgs; [\n    swww\n    imagemagick\n    rofi\n    pastel # The Math Wizard\n    jq     # JSON Wizard\n    gnused\n  ];\n  xdg.configFile = {\n    \"rofi/WallSelect.rasi\".source = ../desktop/rofi/config/WallSelect.rasi;\n    \"wal/templates/zed.template\".source = ./templates/zed.template;\n  };\n  systemd.user.services.create-theme-dirs = {\n    Unit = { Description = \"Create mutable theme directories\"; };\n    Service = {\n      Type = \"oneshot\";\n      ExecStart = \"${pkgs.bash}/bin/bash -c 'mkdir -p %h/.config/niri %h/.config/rofi %h/.config/zed/themes %h/.config/vesktop/themes %h/.config/kitty %h/.config/gtk-4.0 %h/.config/gtk-3.0 %h/.cache/wal'\";\n    };\n    Install.WantedBy = [ \"default.target\" ];\n  };\n}"}
{"p":"modules/home/theme/matugen.toml","c":"[config]\nreload_apps = false\nscheme = \"fruit_salad\"\ncontrast = 0.0\n[config.modes.dark]\n[templates.niri]\ninput_path = \"~/.config/matugen/templates/niri.kdl\"\noutput_path = \"~/.config/niri/colors.kdl\"\n[templates.rofi]\ninput_path = \"~/.config/matugen/templates/rofi.rasi\"\noutput_path = \"~/.config/rofi/colors.rasi\"\n[templates.vesktop]\ninput_path = \"~/.config/matugen/templates/discord.css\"\noutput_path = \"~/.config/vesktop/themes/lis.theme.css\"\n[templates.gtk3]\ninput_path = \"~/.config/matugen/templates/gtk.css\"\noutput_path = \"~/.config/gtk-3.0/gtk.css\"\n[templates.gtk4]\ninput_path = \"~/.config/matugen/templates/gtk.css\"\noutput_path = \"~/.config/gtk-4.0/gtk.css\""}
{"p":"modules/home/theme/scripts.nix","c":"{ pkgs, config, ... }:\nlet\n  wallDir = \"${config.home.homeDirectory}/Pictures/Wallpapers\";\n  cacheDir = \"${config.home.homeDirectory}/.cache/wall-thumbs\";\n  rofiTheme = \"${config.home.homeDirectory}/.config/rofi/WallSelect.rasi\";\nin\n{\n  home.packages = [\n    pkgs.libnotify\n    pkgs.imagemagick\n    pkgs.findutils\n    pkgs.coreutils\n    pkgs.pastel\n    pkgs.jq\n    pkgs.gnused\n    (pkgs.writeShellScriptBin \"theme-engine\" ''\n      set -e\n      IMG=\"$1\"\n      echo \"[Engine] Processing: $IMG\"\n      set +e\n      RAW_HEX=$(${pkgs.imagemagick}/bin/magick \"$IMG\" -scale 1x1! -depth 8 -format \"%[hex:u]\" info: | cut -c1-6)\n      set -e\n      if [ -z \"$RAW_HEX\" ]; then ANCHOR=\"#2E3440\"; else ANCHOR=\"#$RAW_HEX\"; fi\n      BG=$(pastel color \"$ANCHOR\" | pastel set hsl-saturation 0.15 | pastel set hsl-lightness 0.08 | pastel format hex)\n      BG_LIGHT=$(pastel color \"$BG\" | pastel lighten 0.1 | pastel format hex) # Lighter surface\n      FG=$(pastel color \"$ANCHOR\" | pastel set hsl-saturation 0.10 | pastel set hsl-lightness 0.90 | pastel format hex)\n      FG_DIM=$(pastel color \"$FG\" | pastel darken 0.3 | pastel format hex)\n      C_MAIN=$(pastel color \"$ANCHOR\" | pastel set hsl-saturation 0.85 | pastel set hsl-lightness 0.65 | pastel format hex)\n      C_SEC=$(pastel color \"$ANCHOR\" | pastel rotate 30 | pastel set hsl-saturation 0.85 | pastel set hsl-lightness 0.65 | pastel format hex)\n      C_TER=$(pastel color \"$ANCHOR\" | pastel rotate -- -30 | pastel set hsl-saturation 0.85 | pastel set hsl-lightness 0.65 | pastel format hex)\n      C_ACC=$(pastel color \"$ANCHOR\" | pastel rotate 150 | pastel set hsl-saturation 0.75 | pastel set hsl-lightness 0.70 | pastel format hex)\n      ERROR=\"#ff5555\"\n      cat <<EOF > \"$HOME/.config/niri/colors.kdl\"\n      // Generated by theme-engine\n      window-rule {\n          border {\n              active-color \"$C_ACC\"\n              inactive-color \"$BG_LIGHT\"\n              width 2\n          }\n      }\n      EOF\n      cat <<EOF > \"$HOME/.config/rofi/colors.rasi\"\n      * {\n          background:     $BG;\n          background-alt: $BG_LIGHT;\n          foreground:     $FG;\n          selected:       $C_ACC;\n          text-selected:  $BG;\n          active:         $C_MAIN;\n          urgent:         $ERROR;\n      }\n      EOF\n      cat <<EOF > \"$HOME/.config/vesktop/themes/lis.theme.css\"\n      /** Generated by theme-engine **/\n      :root {\n          --background-primary: $BG;\n          --background-secondary: $BG_LIGHT;\n          --background-tertiary: $BG;\n          --text-normal: $FG;\n          --text-muted: $FG_DIM;\n          --header-primary: $C_MAIN;\n          --interactive-active: $C_ACC;\n          --interactive-normal: $FG;\n          --interactive-hover: $C_ACC;\n          --brand-experiment: $C_ACC; /* Accent Color */\n      }\n      EOF\n      cat <<EOF > \"$HOME/.config/gtk-3.0/gtk.css\"\n      @define-color theme_bg_color $BG;\n      @define-color theme_fg_color $FG;\n      @define-color theme_selected_bg_color $C_ACC;\n      @define-color theme_selected_fg_color $BG;\n      window { background: $BG; color: $FG; }\n      view { background: $BG_LIGHT; color: $FG; }\n      headerbar { background: $BG; }\n      EOF\n      cp \"$HOME/.config/gtk-3.0/gtk.css\" \"$HOME/.config/gtk-4.0/gtk.css\"\n      cat <<EOF > \"$HOME/.cache/wal/colors-kitty.conf\"\n      foreground $FG\n      background $BG\n      cursor $C_ACC\n      color0 $BG\n      color8 $BG_LIGHT\n      color1 $ERROR\n      color9 $ERROR\n      color2 $C_TER\n      color10 $C_TER\n      color3 $C_MAIN\n      color11 $C_MAIN\n      color4 $C_SEC\n      color12 $C_SEC\n      color5 $C_ACC\n      color13 $C_ACC\n      color6 $C_SEC\n      color14 $C_SEC\n      color7 $FG\n      color15 $FG\n      EOF\n      TEMPLATE=\"$HOME/.config/wal/templates/zed.template\"\n      OUTPUT=\"$HOME/.config/zed/themes/pywal.json\"\n      if [ -f \"$TEMPLATE\" ]; then\n        cp \"$TEMPLATE\" \"$OUTPUT\"\n        replace() { sed -i \"s|{$1}|$2|g\" \"$OUTPUT\"; }\n        replace \"background\" \"$BG\"\n        replace \"foreground\" \"$FG\"\n        replace \"color0\" \"$BG_LIGHT\" # Lightened BG for active lines\n        replace \"color1\" \"$ERROR\"\n        replace \"color2\" \"$C_TER\"   # Strings\n        replace \"color3\" \"$C_MAIN\"  # Keywords\n        replace \"color4\" \"$C_SEC\"   # Functions\n        replace \"color5\" \"$C_ACC\"   # Accent\n        replace \"color6\" \"$C_TER\"\n        replace \"color7\" \"$FG\"\n        replace \"color8\" \"$FG_DIM\"\n        replace \"color9\" \"$ERROR\"\n        replace \"color10\" \"$C_TER\"\n        replace \"color11\" \"$C_MAIN\"\n        replace \"color12\" \"$C_SEC\"\n        replace \"color13\" \"$C_ACC\"\n        replace \"color14\" \"$C_TER\"\n        replace \"color15\" \"$FG\"\n      fi\n      echo \"[Engine] Configuration Complete.\"\n    '')\n    (pkgs.writeShellScriptBin \"theme-manager\" ''\n      set -e\n      IMG=\"$1\"\n      if [ -z \"$IMG\" ]; then echo \"Usage: theme-manager <path>\"; exit 1; fi\n      if ! pgrep -x swww-daemon > /dev/null; then swww-daemon & sleep 0.5; fi\n      swww img \"$IMG\" --transition-type grow --transition-pos 0.5,0.5 --transition-fps 60 --transition-duration 2\n      ln -sf \"$IMG\" \"$HOME/.cache/current_wallpaper.jpg\"\n      ${pkgs.imagemagick}/bin/magick \"$IMG\" -resize ^640x1080 -gravity center -extent 640x1080 \"$HOME/.cache/rofi-launcher.jpg\" || true\n      theme-engine \"$IMG\"\n      systemctl --user start niri-config-assembler.service\n      niri msg action load-config-file\n      if pgrep -x kitty > /dev/null; then\n          kitty @ --to=unix:@mykitty set-colors -a -c ~/.cache/wal/colors-kitty.conf || true\n      fi\n      notify-send \"Theme Active\" \"$(basename \"$IMG\")\" -i \"$IMG\"\n    '')\n    (pkgs.writeShellScriptBin \"wall-select\" ''\n      THUMB_WIDTH=415\n      THUMB_HEIGHT=550\n      GEO=\"415x550\"\n      export PATH=${pkgs.imagemagick}/bin:${pkgs.coreutils}/bin:${pkgs.rofi}/bin:${pkgs.findutils}/bin:${pkgs.libnotify}/bin:$PATH\n      export CACHE_DIR=\"${cacheDir}\"\n      mkdir -p \"$CACHE_DIR\"\n      if [ ! -d \"${wallDir}\" ]; then\n        notify-send \"Error\" \"Wallpaper dir missing: ${wallDir}\" -u critical\n        exit 1\n      fi\n      find -L \"${wallDir}\" -type f \\( -iname \"*.jpg\" -o -iname \"*.jpeg\" -o -iname \"*.png\" -o -iname \"*.webp\" \\) -print0 | \\\n      xargs -0 -P $(nproc) -I {} sh -c '\n        img=\"{}\"\n        filename=$(basename \"$img\")\n        cache=\"$CACHE_DIR/$filename\"\n        if [ ! -f \"$cache\" ]; then\n          magick \"$img\" -thumbnail \"415x550^\" -gravity center -extent 415x550 \"$cache\" 2>/dev/null || true\n        fi\n      '\n      SELECTED=$( \\\n        find -L \"${wallDir}\" -type f \\( -iname \"*.jpg\" -o -iname \"*.jpeg\" -o -iname \"*.png\" -o -iname \"*.webp\" \\) -print0 | \\\n        xargs -0 basename -a | \\\n        sort | \\\n        while IFS= read -r filename; do\n            printf \"%s\\0icon\\x1f%s/%s\\n\" \"$filename\" \"$CACHE_DIR\" \"$filename\"\n        done | \\\n        ${pkgs.rofi}/bin/rofi -dmenu -theme \"${rofiTheme}\" -p \"Select Wallpaper\" -show-icons \\\n      )\n      if [ -n \"$SELECTED\" ]; then\n        theme-manager \"${wallDir}/$SELECTED\"\n      fi\n    '')\n  ];\n}"}
{"p":"modules/home/theme/templates/discord.css","c":"/*\n   Midnight Discord - Matugen Integration\n   Based on: https://github.com/kirisaki-vk/midnight-discord-matugen\n*/\n@import url(\"https://refact0r.github.io/midnight-discord/build/midnight.css\");\n:root {\n    /* Matugen Colors -> Midnight Variables */\n    --primary-100: {{colors.primary.default.hex}};\n    --primary-200: {{colors.primary_container.default.hex}};\n    --primary-300: {{colors.on_primary.default.hex}};\n    --accent-100: {{colors.tertiary.default.hex}};\n    --accent-200: {{colors.tertiary_container.default.hex}};\n    --accent-300: {{colors.on_tertiary.default.hex}};\n    --background-100: {{colors.surface.default.hex}};\n    --background-200: {{colors.surface_container.default.hex}};\n    --background-300: {{colors.surface_container_high.default.hex}};\n    --text-0: {{colors.on_surface.default.hex}};\n    --text-1: {{colors.on_surface_variant.default.hex}};\n    --text-2: {{colors.outline.default.hex}};\n    /* Status Colors */\n    --success: {{colors.primary.default.hex}};\n    --danger: {{colors.error.default.hex}};\n    /* Window Transparency */\n    --window-padding: 20px;\n    --window-roundness: 12px;\n}"}
{"p":"modules/home/theme/templates/gtk.css","c":"@define-color theme_bg_color {{colors.surface.default.hex}};\n@define-color theme_fg_color {{colors.on_surface.default.hex}};\n@define-color theme_selected_bg_color {{colors.primary.default.hex}};\n@define-color theme_selected_fg_color {{colors.on_primary.default.hex}};\n/* Window Backgrounds */\nwindow { background: @theme_bg_color; color: @theme_fg_color; }\nview { background: {{colors.surface_container_lowest.default.hex}}; color: @theme_fg_color; }\nheaderbar { background: {{colors.surface_container.default.hex}}; }\npopover { background: {{colors.surface_container_high.default.hex}}; }"}
{"p":"modules/home/theme/templates/kitty.conf","c":"foreground {{colors.on_surface.default.hex}}\nbackground {{colors.surface_container_lowest.default.hex}}\ncursor {{colors.primary.default.hex}}\nselection_background {{colors.primary.default.hex}}\nselection_foreground {{colors.on_primary.default.hex}}\ncolor0 {{colors.surface_container_high.default.hex}}\ncolor8 {{colors.outline.default.hex}}\ncolor1 {{colors.error.default.hex}}\ncolor9 {{colors.error_container.default.hex}}\ncolor2 {{colors.tertiary.default.hex}}\ncolor10 {{colors.tertiary_container.default.hex}}\ncolor3 {{colors.primary_container.default.hex}}\ncolor11 {{colors.on_primary_container.default.hex}}\ncolor4 {{colors.secondary.default.hex}}\ncolor12 {{colors.secondary_container.default.hex}}\ncolor5 {{colors.primary.default.hex}}\ncolor13 {{colors.on_primary.default.hex}}\ncolor6 {{colors.on_secondary_container.default.hex}}\ncolor14 {{colors.on_secondary.default.hex}}\ncolor7 {{colors.on_surface.default.hex}}\ncolor15 {{colors.inverse_on_surface.default.hex}}\nactive_tab_foreground   {{colors.on_primary.default.hex}}\nactive_tab_background   {{colors.primary.default.hex}}\ninactive_tab_foreground {{colors.on_surface_variant.default.hex}}\ninactive_tab_background {{colors.surface_container.default.hex}}"}
{"p":"modules/home/theme/templates/niri.kdl","c":"// Generated by Matugen\nwindow-rule {\n    border {\n        active-color \"{{colors.primary.default.hex}}\"\n        inactive-color \"{{colors.surface_container_highest.default.hex}}\"\n        width 2\n    }\n}"}
{"p":"modules/home/theme/templates/rofi.rasi","c":"* {\n    background:     {{colors.surface.default.hex}};\n    background-alt: {{colors.surface_container_high.default.hex}};\n    foreground:     {{colors.on_surface.default.hex}};\n    selected:       {{colors.primary.default.hex}};\n    text-selected:  {{colors.on_primary.default.hex}}; /* <--- ADDED THIS */\n    active:         {{colors.tertiary.default.hex}};\n    urgent:         {{colors.error.default.hex}};\n}"}
{"p":"modules/home/theme/templates/zed.json","c":"{\n  \"$schema\": \"https://zed.dev/schema/themes/v0.1.0.json\",\n  \"name\": \"Matugen\",\n  \"author\": \"Matugen\",\n  \"themes\": [\n    {\n      \"name\": \"Matugen\",\n      \"appearance\": \"dark\",\n      \"style\": {\n        \"border\": \"{{colors.outline.default.hex}}\",\n        \"border.variant\": \"{{colors.surface_container_high.default.hex}}\",\n        \"elevated_surface.background\": \"{{colors.surface_container_highest.default.hex}}\",\n        \"surface.background\": \"{{colors.surface_container.default.hex}}\",\n        \"editor.background\": \"{{colors.surface.default.hex}}\",\n        \"editor.foreground\": \"{{colors.on_surface.default.hex}}\",\n        \"editor.active_line.background\": \"{{colors.surface_container_highest.default.hex}}\",\n        \"editor.line_number\": \"{{colors.on_surface_variant.default.hex}}\",\n        \"editor.active_line_number\": \"{{colors.primary_fixed.default.hex}}\",\n        \"tab_bar.background\": \"{{colors.surface.default.hex}}\",\n        \"tab.inactive_background\": \"{{colors.surface.default.hex}}\",\n        \"tab.active_background\": \"{{colors.surface_container_high.default.hex}}\",\n        \"toolbar.background\": \"{{colors.surface.default.hex}}\",\n        \"status_bar.background\": \"{{colors.surface_container_highest.default.hex}}\",\n        \"panel.background\": \"{{colors.surface_container_low.default.hex}}\",\n        \"git.created\": \"{{colors.primary_fixed.default.hex}}\",\n        \"git.modified\": \"{{colors.tertiary_fixed.default.hex}}\",\n        \"git.deleted\": \"{{colors.error.default.hex}}\",\n        \"git.ignored\": \"{{colors.outline.default.hex}}\",\n        \"git.conflict\": \"{{colors.error_container.default.hex}}\",\n        \"terminal.background\": \"{{colors.surface.default.hex}}\",\n        \"terminal.ansi.black\": \"{{colors.surface_container_highest.default.hex}}\",\n        \"terminal.ansi.red\": \"{{colors.error.default.hex}}\",\n        \"terminal.ansi.green\": \"{{colors.primary_fixed.default.hex}}\",\n        \"terminal.ansi.yellow\": \"{{colors.tertiary_fixed.default.hex}}\",\n        \"terminal.ansi.blue\": \"{{colors.secondary_fixed.default.hex}}\",\n        \"terminal.ansi.magenta\": \"{{colors.primary_fixed_dim.default.hex}}\",\n        \"terminal.ansi.cyan\": \"{{colors.on_secondary_container.default.hex}}\",\n        \"terminal.ansi.white\": \"{{colors.on_surface.default.hex}}\",\n        \"syntax\": {\n          \"comment\": {\n            \"color\": \"{{colors.on_surface_variant.default.hex}}\",\n            \"font_style\": \"italic\"\n          },\n          \"doc_comment\": {\n            \"color\": \"{{colors.on_surface_variant.default.hex}}\",\n            \"font_style\": \"italic\"\n          },\n          \"keyword\": {\n            \"color\": \"{{colors.primary_fixed.default.hex}}\",\n            \"font_weight\": 700\n          },\n          \"type\": {\n            \"color\": \"{{colors.secondary_fixed.default.hex}}\",\n            \"font_weight\": 700\n          },\n          \"function\": {\n            \"color\": \"{{colors.on_tertiary_container.default.hex}}\",\n            \"font_weight\": 700\n          },\n          \"method\": {\n            \"color\": \"{{colors.on_tertiary_container.default.hex}}\",\n            \"font_weight\": 700\n          },\n          \"string\": { \"color\": \"{{colors.tertiary_fixed.default.hex}}\" },\n          \"string.escape\": { \"color\": \"{{colors.primary_fixed.default.hex}}\" },\n          \"string.regex\": { \"color\": \"{{colors.primary_fixed.default.hex}}\" },\n          \"property\": {\n            \"color\": \"{{colors.on_secondary_container.default.hex}}\"\n          },\n          \"variable\": { \"color\": \"{{colors.on_surface.default.hex}}\" },\n          \"variable.special\": {\n            \"color\": \"{{colors.primary_fixed.default.hex}}\"\n          },\n          \"number\": { \"color\": \"{{colors.error.default.hex}}\" },\n          \"boolean\": { \"color\": \"{{colors.error.default.hex}}\" },\n          \"constant\": { \"color\": \"{{colors.error.default.hex}}\" },\n          \"operator\": { \"color\": \"{{colors.outline.default.hex}}\" },\n          \"punctuation\": { \"color\": \"{{colors.outline.default.hex}}\" },\n          \"punctuation.bracket\": {\n            \"color\": \"{{colors.on_surface_variant.default.hex}}\"\n          },\n          \"punctuation.delimiter\": {\n            \"color\": \"{{colors.on_surface_variant.default.hex}}\"\n          }\n        }\n      }\n    }\n  ]\n}"}
{"p":"modules/home/theme/templates/zed.template","c":"{\n  \"$schema\": \"https://zed.dev/schema/themes/v0.1.0.json\",\n  \"name\": \"Pywal\",\n  \"author\": \"Pywal\",\n  \"themes\": [\n    {\n      \"name\": \"Pywal\",\n      \"appearance\": \"dark\",\n      \"style\": {\n        \"border\": \"{color8}\",\n        \"border.variant\": \"{color0}\",\n        \"elevated_surface.background\": \"{background}\",\n        \"surface.background\": \"{background}\",\n        \"editor.background\": \"{background}\",\n        \"editor.foreground\": \"{foreground}\",\n        \"editor.active_line.background\": \"{color0}\",\n        \"editor.line_number\": \"{color8}\",\n        \"editor.active_line_number\": \"{color7}\",\n        \"tab_bar.background\": \"{background}\",\n        \"tab.inactive_background\": \"{background}\",\n        \"tab.active_background\": \"{color0}\",\n        \"toolbar.background\": \"{background}\",\n        \"status_bar.background\": \"{color0}\",\n        \"panel.background\": \"{background}\",\n        \"terminal.background\": \"{background}\",\n        \"terminal.ansi.black\": \"{color0}\",\n        \"terminal.ansi.red\": \"{color1}\",\n        \"terminal.ansi.green\": \"{color2}\",\n        \"terminal.ansi.yellow\": \"{color3}\",\n        \"terminal.ansi.blue\": \"{color4}\",\n        \"terminal.ansi.magenta\": \"{color5}\",\n        \"terminal.ansi.cyan\": \"{color6}\",\n        \"terminal.ansi.white\": \"{color7}\",\n        \"terminal.ansi.bright_black\": \"{color8}\",\n        \"terminal.ansi.bright_red\": \"{color9}\",\n        \"terminal.ansi.bright_green\": \"{color10}\",\n        \"terminal.ansi.bright_yellow\": \"{color11}\",\n        \"terminal.ansi.bright_blue\": \"{color12}\",\n        \"terminal.ansi.bright_magenta\": \"{color13}\",\n        \"terminal.ansi.bright_cyan\": \"{color14}\",\n        \"terminal.ansi.bright_white\": \"{color15}\",\n        \"conflict\": \"{color3}\",\n        \"created\": \"{color2}\",\n        \"deleted\": \"{color1}\",\n        \"error\": \"{color1}\",\n        \"hidden\": \"{color8}\",\n        \"hint\": \"{color8}\",\n        \"ignored\": \"{color8}\",\n        \"info\": \"{color4}\",\n        \"modified\": \"{color3}\",\n        \"predictive\": \"{color8}\",\n        \"renamed\": \"{color3}\",\n        \"success\": \"{color2}\",\n        \"unreachable\": \"{color8}\",\n        \"warning\": \"{color3}\",\n        \"syntax\": {\n          \"comment\": { \"color\": \"{color8}\", \"font_style\": \"italic\" },\n          \"doc_comment\": { \"color\": \"{color8}\", \"font_style\": \"italic\" },\n          \"keyword\": { \"color\": \"{color5}\", \"font_weight\": 700 },\n          \"type\": { \"color\": \"{color4}\", \"font_weight\": 700 },\n          \"function\": { \"color\": \"{color3}\", \"font_weight\": 700 },\n          \"method\": { \"color\": \"{color3}\", \"font_weight\": 700 },\n          \"string\": { \"color\": \"{color2}\" },\n          \"string.escape\": { \"color\": \"{color6}\" },\n          \"string.regex\": { \"color\": \"{color6}\" },\n          \"property\": { \"color\": \"{color4}\" },\n          \"variable\": { \"color\": \"{foreground}\" },\n          \"variable.special\": { \"color\": \"{color6}\" },\n          \"number\": { \"color\": \"{color1}\" },\n          \"boolean\": { \"color\": \"{color1}\" },\n          \"constant\": { \"color\": \"{color1}\" },\n          \"operator\": { \"color\": \"{color5}\" },\n          \"punctuation\": { \"color\": \"{foreground}\" },\n          \"punctuation.bracket\": { \"color\": \"{foreground}\" },\n          \"punctuation.delimiter\": { \"color\": \"{foreground}\" }\n        }\n      }\n    }\n  ]\n}"}
